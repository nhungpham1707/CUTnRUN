mkdir: cannot create directory ‘/remove_zero’: Permission denied
start running cut and run analysis at Wed May 31 07:11:58 CEST 2023
read first file name
get bed file
get first file signals
SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph
get all file signals
get average_ref
get reference mean
get output bedgraph file
User provide reference.bedgraph: -r average_ref.bedgraph
User provide target.bedgraph: -t SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph
User provide outputname: -o SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p z
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
test
('sig1_raw[:,1] is', array(['30600', '30800', '54400', ..., '70600', '70800', '71000'],
      dtype='|S10'), 'sig2_raw[:,1] is', array(['30600', '30800', '54400', ..., '70600', '70800', '71000'],
      dtype='|S10'), 'bin_num is', 13784097)
('length sig1', 13784097)
('length sig2', 13784097)
check peak number in reference
reference_pk_num
5698
check peak number in target
target_pk_num
5698
fdr peak number < bin_num * rank_lim
use rank for reference
22.0
fdr peak number < bin_num * rank_lim
use rank for target
22.0
reference_pk_num
5698
target_pk_num
5698
use FDR common peaks
use FDR common background
common peaks number:
14243
common background number:
13769854
check!!!
13784097
Iteration 0 | dFB: 0.093886
[0.22733697531887412, 1.9061140417739997]
Iteration 10 | dFB: 0.058487
[0.7692958901233506, 1.183539062215881]
Iteration 20 | dFB: 0.000611
[0.9991558422558465, 1.0006158383182966]
converged!
used: [A, B]
[0.9999867523061192, 1.000009661940876]
transformation: B: 1.000009661940876; A: 0.9999867523061192
[1] "args in R are"
[1] "SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph.s3norm.bedgraph"             
[2] "SCC-bulkChIC-PMC-DRO-020_nozeroes_augmented.bedgraph"                             
[3] "SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph"
[1] "sig_raw in r script is"
    V1    V2    V3        V4
1 chr1 30600 30800 0.9999868
2 chr1 30800 31000 0.9999868
3 chr1 54400 54600 0.9999868
4 chr1 54600 54800 0.9999868
5 chr1 54800 55000 0.9999868
6 chr1 55000 55200 0.9999868
[1] "input_raw in r script is"
    V1    V2    V3 V4
1 chr1 30600 30800  1
2 chr1 30800 31000  1
3 chr1 54400 54600  1
4 chr1 54600 54800  1
5 chr1 54800 55000  1
6 chr1 55000 55200  1
[1] "head sig is"
[1] 0.9999868 0.9999868 0.9999868 0.9999868 0.9999868 0.9999868
[1] "min_non0 is"
[1] 1.999987
[1] "x in get_true_NB_prob_size is"
[1] "double"
[1] "numeric"
 num [1:7586137] 2 3 2 2 3 ...
NULL
[1] "dim is"
[1] "head is"
[1] "m in gettrue is 4.1204093201909"
[1] "m2 in get true is 22.4958768524558"
[1] "p0 in get true is 0"
[1] "p in p is 0.746707456929507"
[1] "1-p0 is 1"
[1] "m^2 is 16.9777729659161"
[1] "m2-m^2 is 5.51810388653972"
[1] "rt is 0.746707456929507" "rt is 12.1469835933232" 
[3] "rt is 0"                
[1] "op os p0 before problematic comparison 0.746707456929507 12.1469835933232 0.028784657329099"
[1] "p in problematic comparison is 0.685957095544811"
[1] "1-p0 problematic comparison is 0.971215342670901"
[1] "m^2  problematic comparison is 16.9777729659161"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810388653972"
[1] "p in  problematic comparison comparison is 0.685957095544811"
[1] "op os p0 before problematic comparison 0.685957095544811 8.74105520043263 0.0370734180120407"
[1] "p in problematic comparison is 0.670254669289255"
[1] "1-p0 problematic comparison is 0.962926581987959"
[1] "m^2  problematic comparison is 16.9777729659161"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810388653972"
[1] "p in  problematic comparison comparison is 0.670254669289255"
[1] "op os p0 before problematic comparison 0.670254669289255 8.06482095610715 0.0396876593193496"
[1] "p in problematic comparison is 0.665450243715117"
[1] "1-p0 problematic comparison is 0.96031234068065"
[1] "m^2  problematic comparison is 16.9777729659161"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810388653972"
[1] "p in  problematic comparison comparison is 0.665450243715117"
[1] "op os p0 before problematic comparison 0.665450243715117 7.87059819017751 0.0405334780346055"
[1] "p in problematic comparison is 0.663910520031201"
[1] "1-p0 problematic comparison is 0.959466521965395"
[1] "m^2  problematic comparison is 16.9777729659161"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810388653972"
[1] "p in  problematic comparison comparison is 0.663910520031201"
[1] "op os p0 before problematic comparison 0.663910520031201 7.80952857399728 0.0408093286529574"
[1] "p in problematic comparison is 0.663409902766478"
[1] "1-p0 problematic comparison is 0.959190671347043"
[1] "m^2  problematic comparison is 16.9777729659161"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810388653972"
[1] "p in  problematic comparison comparison is 0.663409902766478"
[1] "op os p0 before problematic comparison 0.663409902766478 7.78979309794838 0.040899524979233"
[1] "p in problematic comparison is 0.663246377055461"
[1] "1-p0 problematic comparison is 0.959100475020767"
[1] "m^2  problematic comparison is 16.9777729659161"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810388653972"
[1] "p in  problematic comparison comparison is 0.663246377055461"
[1] "op os p0 before problematic comparison 0.663246377055461 7.78335925475815 0.0409290417009633"
[1] "p in problematic comparison is 0.663192880819752"
[1] "1-p0 problematic comparison is 0.959070958299037"
[1] "m^2  problematic comparison is 16.9777729659161"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810388653972"
[1] "p in  problematic comparison comparison is 0.663192880819752"
[1] "op os p0 before problematic comparison 0.663192880819752 7.78125582641715 0.0409387036892235"
[1] "p in problematic comparison is 0.66317537126466"
[1] "1-p0 problematic comparison is 0.959061296310777"
[1] "m^2  problematic comparison is 16.9777729659161"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810388653972"
[1] "p in  problematic comparison comparison is 0.66317537126466"
[1] "op os p0 before problematic comparison 0.66317537126466 7.78056751013093 0.0409418667232652"
[1] "p in problematic comparison is 0.663169639382523"
[1] "1-p0 problematic comparison is 0.959058133276735"
[1] "m^2  problematic comparison is 16.9777729659161"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810388653972"
[1] "p in  problematic comparison comparison is 0.663169639382523"
[1] "op os p0 before problematic comparison 0.663169639382523 7.78034220026017 0.0409429022325195"
[1] "p in problematic comparison is 0.66316776290923"
[1] "1-p0 problematic comparison is 0.95905709776748"
[1] "m^2  problematic comparison is 16.9777729659161"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810388653972"
[1] "p in  problematic comparison comparison is 0.66316776290923"
[1] "op os p0 before problematic comparison 0.66316776290923 7.78026844117109 0.040943241239218"
[1] "p in problematic comparison is 0.663167148588669"
[1] "1-p0 problematic comparison is 0.959056758760782"
[1] "m^2  problematic comparison is 16.9777729659161"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810388653972"
[1] "p in  problematic comparison comparison is 0.663167148588669"
[1] "op os p0 before problematic comparison 0.663167148588669 7.7802442940702 0.04094335222413"
[1] "p in problematic comparison is 0.663166947471021"
[1] "1-p0 problematic comparison is 0.95905664777587"
[1] "m^2  problematic comparison is 16.9777729659161"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810388653972"
[1] "p in  problematic comparison comparison is 0.663166947471021"
[1] "summary negative log10 NB p-value:"
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.0000  0.2524  0.3292  0.3818 57.7642 
[1] "output_name in r script is"
[1] "SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph"
[1] "dim neglog10_nb_pval_bedgraph is 13784097"
[2] "dim neglog10_nb_pval_bedgraph is 4"       
[1] "head neglog10_nb_pval_bedgraph is"
    V1    V2    V3 neglog10_nb_pval
1 chr1 30600 30800                0
2 chr1 30800 31000                0
3 chr1 54400 54600                0
4 chr1 54600 54800                0
5 chr1 54800 55000                0
6 chr1 55000 55200                0
read first file name
get bed file
get first file signals
SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph
get all file signals
get average_ref
get reference mean
get output bedgraph file
/hpc/pmc_drost/nhung/anaconda3/envs/s3norm/lib/python2.7/site-packages/numpy/core/fromnumeric.py:3118: RuntimeWarning: Mean of empty slice.
  out=out, **kwargs)
/hpc/pmc_drost/nhung/anaconda3/envs/s3norm/lib/python2.7/site-packages/numpy/core/_methods.py:85: RuntimeWarning: invalid value encountered in double_scalars
  ret = ret.dtype.type(ret / rcount)
/hpc/pmc_drost/nhung/S3norm/src//s3norm.py:112: RuntimeWarning: invalid value encountered in greater
  sig2_pk_transformed[sig2_pk_transformed>upperlim] = upperlim
User provide reference.bedgraph: -r average_ref.bedgraph.NBP.bedgraph
User provide target.bedgraph: -t SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph
User provide outputname: -o SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph.NBP
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p neglog10p
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
User provide cross_mark: -c F
start S3norm.......
test
('sig1_raw[:,1] is', array(['30600', '30800', '54400', ..., '70600', '70800', '71000'],
      dtype='|S10'), 'sig2_raw[:,1] is', array(['30600', '30800', '54400', ..., '70600', '70800', '71000'],
      dtype='|S17'), 'bin_num is', 13784097)
('length sig1', 13784097)
('length sig2', 13784097)
check peak number in reference
reference_pk_num
7709167
check peak number in target
target_pk_num
9038
fdr peak number < bin_num * rank_lim
use rank for target
4.07681580514615
reference_pk_num
7709167
target_pk_num
9038
use FDR common peaks
use FDR common background
common peaks number:
15006
common background number:
6074930
check!!!
0
Iteration 0 | dFB: nan
[nan, nan]
Iteration 10 | dFB: nan
[nan, nan]
Iteration 20 | dFB: nan
[nan, nan]
Iteration 30 | dFB: nan
[nan, nan]
Iteration 40 | dFB: nan
[nan, nan]
Iteration 50 | dFB: nan
[nan, nan]
Iteration 60 | dFB: nan
[nan, nan]
Iteration 70 | dFB: nan
[nan, nan]
Iteration 80 | dFB: nan
[nan, nan]
Iteration 90 | dFB: nan
[nan, nan]
Iteration 100 | dFB: nan
[nan, nan]
Iteration 110 | dFB: nan
[nan, nan]
Iteration 120 | dFB: nan
[nan, nan]
Iteration 130 | dFB: nan
[nan, nan]
Iteration 140 | dFB: nan
[nan, nan]
Iteration 150 | dFB: nan
[nan, nan]
Iteration 160 | dFB: nan
[nan, nan]
Iteration 170 | dFB: nan
[nan, nan]
Iteration 180 | dFB: nan
[nan, nan]
Iteration 190 | dFB: nan
[nan, nan]
used: [A, B]
Traceback (most recent call last):
  File "/hpc/pmc_drost/nhung/S3norm/src//s3norm.py", line 477, in <module>
    main(sys.argv[1:])
  File "/hpc/pmc_drost/nhung/S3norm/src//s3norm.py", line 474, in main
    s3norm(sig1_wg_raw, sig2_wg_raw, sig2_output_name, NTmethod, B_init, fdr_thresh, rank_lim, upperlim, lowerlim, p_method, common_pk_binary, common_bg_binary, cross_mark)
  File "/hpc/pmc_drost/nhung/S3norm/src//s3norm.py", line 300, in s3norm
    AB = NewtonRaphsonMethod(sig1_cpk, sig1_cbg, sig2_cpk, sig2_cbg, upperlim, 0.5, 2.0, NTmethod, 1e-5, 200)
  File "/hpc/pmc_drost/nhung/S3norm/src//s3norm.py", line 173, in NewtonRaphsonMethod
    print(used_AB)
UnboundLocalError: local variable 'used_AB' referenced before assignment
mv: cannot stat '*.NBP.info.txt': No such file or directory
mv: cannot stat '*.NBP.s3norm.bedgraph': No such file or directory
User provide script_folder: -s /hpc/pmc_drost/nhung/S3norm/src/
User provide input_file_list: -t /hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/modify_bedgraph/s3norm_anti_SFPQ_Samples/anti_SFPQ_w_control.csv
Default reference_method: -m max1
Default NTmethod: -m non0mean
Default B_init: -i 2.0
Default fdr_thresh: -f 0.05
Default rank_lim: -l 0.001
Default upperlim: -a 100000
Default lowerlim: -b 0
Default p_method: -p z
Default common_pk_binary: -k 0
Default common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
('Filelist is', '/hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/modify_bedgraph/s3norm_anti_SFPQ_Samples/anti_SFPQ_w_control.csv')
('script_folder is', '/hpc/pmc_drost/nhung/S3norm/src/')
Get average reference......
Get average reference......Done
Get S3norm normalized read counts......
Get S3norm normalized read counts......Done
Get signal track of negative log10 p-value based on a NB background model......
Get signal track of negative log10 p-value based on a NB background model......Done
Get NBP average reference......
Get NBP average reference......Done
Get S3norm normalized negative log10 p-value based on NB background model......
Get S3norm normalized negative log10 p-value based on NB background model......Done
Organize folder......
Save S3norm_NBP_bedgraph
Save S3norm_rc_bedgraph
Save NBP_bedgraph
Save average_ref_bedgraph
Organize folder......Done

real	7m34.099s
user	7m56.802s
sys	0m24.834s
read first file name
get bed file
get first file signals
SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph
get all file signals
get average_ref
get reference mean
get output bedgraph file
User provide reference.bedgraph: -r average_ref.bedgraph
User provide target.bedgraph: -t SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph
User provide outputname: -o SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph
User provide NTmethod: -m mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p z
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
test
('sig1_raw[:,1] is', array(['30600', '30800', '54400', ..., '70600', '70800', '71000'],
      dtype='|S10'), 'sig2_raw[:,1] is', array(['30600', '30800', '54400', ..., '70600', '70800', '71000'],
      dtype='|S10'), 'bin_num is', 13784097)
('length sig1', 13784097)
('length sig2', 13784097)
check peak number in reference
reference_pk_num
5698
check peak number in target
target_pk_num
5698
fdr peak number < bin_num * rank_lim
use rank for reference
22.0
fdr peak number < bin_num * rank_lim
use rank for target
22.0
reference_pk_num
5698
target_pk_num
5698
use FDR common peaks
use FDR common background
common peaks number:
14243
common background number:
13769854
check!!!
13784097
34.567387488590896
2.938174536926844
Iteration 0 | dFB: 0.093951
[0.2265723709105193, 1.9060489042930318]
Iteration 10 | dFB: 0.058448
[0.7679334446118766, 1.1834504773886978]
Iteration 20 | dFB: 0.000612
[0.9991466188850316, 1.0006166862352754]
converged!
used: [A, B]
[0.9999866071204934, 1.0000096754383423]
transformation: B: 1.0000096754383423; A: 0.9999866071204934
[1] "args in R are"
[1] "SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph.s3norm.bedgraph"             
[2] "SCC-bulkChIC-PMC-DRO-020_nozeroes_augmented.bedgraph"                             
[3] "SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph"
[1] "sig_raw in r script is"
    V1    V2    V3        V4
1 chr1 30600 30800 0.9999866
2 chr1 30800 31000 0.9999866
3 chr1 54400 54600 0.9999866
4 chr1 54600 54800 0.9999866
5 chr1 54800 55000 0.9999866
6 chr1 55000 55200 0.9999866
[1] "input_raw in r script is"
    V1    V2    V3 V4
1 chr1 30600 30800  1
2 chr1 30800 31000  1
3 chr1 54400 54600  1
4 chr1 54600 54800  1
5 chr1 54800 55000  1
6 chr1 55000 55200  1
[1] "head sig is"
[1] 0.9999866 0.9999866 0.9999866 0.9999866 0.9999866 0.9999866
[1] "min_non0 is"
[1] 1.999987
[1] "x in get_true_NB_prob_size is"
[1] "double"
[1] "numeric"
 num [1:7586137] 2 3 2 2 3 ...
NULL
[1] "dim is"
[1] "head is"
[1] "m in gettrue is 4.12040880863699"
[1] "m2 in get true is 22.4958714307002"
[1] "p0 in get true is 0"
[1] "p in p is 0.746707527438253"
[1] "1-p0 is 1"
[1] "m^2 is 16.9777687502933"
[1] "m2-m^2 is 5.51810268040684"
[1] "rt is 0.746707527438253" "rt is 12.1469866135958" 
[3] "rt is 0"                
[1] "op os p0 before problematic comparison 0.746707527438253 12.1469866135958 0.0287846649520562"
[1] "p in problematic comparison is 0.685957147196591"
[1] "1-p0 problematic comparison is 0.971215335047944"
[1] "m^2  problematic comparison is 16.9777687502933"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810268040684"
[1] "p in  problematic comparison comparison is 0.685957147196591"
[1] "op os p0 before problematic comparison 0.685957147196591 8.74105614247691 0.0370734292488872"
[1] "p in problematic comparison is 0.670254713818682"
[1] "1-p0 problematic comparison is 0.962926570751113"
[1] "m^2  problematic comparison is 16.9777687502933"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810268040684"
[1] "p in  problematic comparison comparison is 0.670254713818682"
[1] "op os p0 before problematic comparison 0.670254713818682 8.06482148562506 0.0396876721757843"
[1] "p in problematic comparison is 0.665450285245525"
[1] "1-p0 problematic comparison is 0.960312327824216"
[1] "m^2  problematic comparison is 16.9777687502933"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810268040684"
[1] "p in  problematic comparison comparison is 0.665450285245525"
[1] "op os p0 before problematic comparison 0.665450285245525 7.87059857590527 0.0405334915766968"
[1] "p in problematic comparison is 0.663910560315084"
[1] "1-p0 problematic comparison is 0.959466508423303"
[1] "m^2  problematic comparison is 16.9777687502933"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810268040684"
[1] "p in  problematic comparison comparison is 0.663910560315084"
[1] "op os p0 before problematic comparison 0.663910560315084 7.80952890412039 0.0408093424724347"
[1] "p in problematic comparison is 0.663409942548713"
[1] "1-p0 problematic comparison is 0.959190657527565"
[1] "m^2  problematic comparison is 16.9777687502933"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810268040684"
[1] "p in  problematic comparison comparison is 0.663409942548713"
[1] "op os p0 before problematic comparison 0.663409942548713 7.78979340642075 0.0408995389071449"
[1] "p in problematic comparison is 0.663246416641841"
[1] "1-p0 problematic comparison is 0.959100461092855"
[1] "m^2  problematic comparison is 16.9777687502933"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810268040684"
[1] "p in  problematic comparison comparison is 0.663246416641841"
[1] "op os p0 before problematic comparison 0.663246416641841 7.78335955492837 0.0409290556701858"
[1] "p in problematic comparison is 0.663192920331522"
[1] "1-p0 problematic comparison is 0.959070944329814"
[1] "m^2  problematic comparison is 16.9777687502933"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810268040684"
[1] "p in  problematic comparison comparison is 0.663192920331522"
[1] "op os p0 before problematic comparison 0.663192920331522 7.78125612346067 0.0409387176738782"
[1] "p in problematic comparison is 0.663175410748551"
[1] "1-p0 problematic comparison is 0.959061282326122"
[1] "m^2  problematic comparison is 16.9777687502933"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810268040684"
[1] "p in  problematic comparison comparison is 0.663175410748551"
[1] "op os p0 before problematic comparison 0.663175410748551 7.78056780601556 0.0409418807135976"
[1] "p in problematic comparison is 0.663169678856154"
[1] "1-p0 problematic comparison is 0.959058119286402"
[1] "m^2  problematic comparison is 16.9777687502933"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810268040684"
[1] "p in  problematic comparison comparison is 0.663169678856154"
[1] "op os p0 before problematic comparison 0.663169678856154 7.78034249572093 0.0409429162249155"
[1] "p in problematic comparison is 0.663167802379132"
[1] "1-p0 problematic comparison is 0.959057083775085"
[1] "m^2  problematic comparison is 16.9777687502933"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810268040684"
[1] "p in  problematic comparison comparison is 0.663167802379132"
[1] "op os p0 before problematic comparison 0.663167802379132 7.78026873647852 0.0409432552323566"
[1] "p in problematic comparison is 0.663167188057228"
[1] "1-p0 problematic comparison is 0.959056744767643"
[1] "m^2  problematic comparison is 16.9777687502933"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810268040684"
[1] "p in  problematic comparison comparison is 0.663167188057228"
[1] "op os p0 before problematic comparison 0.663167188057228 7.78024458932262 0.0409433662175337"
[1] "p in problematic comparison is 0.663166986939101"
[1] "1-p0 problematic comparison is 0.959056633782466"
[1] "m^2  problematic comparison is 16.9777687502933"
[1] "m2-m^2 problematic comparison problematic comparison is 5.51810268040684"
[1] "p in  problematic comparison comparison is 0.663166986939101"
[1] "summary negative log10 NB p-value:"
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.0000  0.2524  0.3292  0.3818 57.7643 
[1] "output_name in r script is"
[1] "SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph"
[1] "dim neglog10_nb_pval_bedgraph is 13784097"
[2] "dim neglog10_nb_pval_bedgraph is 4"       
[1] "head neglog10_nb_pval_bedgraph is"
    V1    V2    V3 neglog10_nb_pval
1 chr1 30600 30800                0
2 chr1 30800 31000                0
3 chr1 54400 54600                0
4 chr1 54600 54800                0
5 chr1 54800 55000                0
6 chr1 55000 55200                0
read first file name
get bed file
get first file signals
SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph
get all file signals
get average_ref
get reference mean
get output bedgraph file
User provide reference.bedgraph: -r average_ref.bedgraph.NBP.bedgraph
User provide target.bedgraph: -t SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph
User provide outputname: -o SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph.NBP
User provide NTmethod: -m mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p neglog10p
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
User provide cross_mark: -c F
start S3norm.......
test
('sig1_raw[:,1] is', array(['30600', '30800', '54400', ..., '70600', '70800', '71000'],
      dtype='|S10'), 'sig2_raw[:,1] is', array(['30600', '30800', '54400', ..., '70600', '70800', '71000'],
      dtype='|S17'), 'bin_num is', 13784097)
('length sig1', 13784097)
('length sig2', 13784097)
check peak number in reference
reference_pk_num
7709167
check peak number in target
target_pk_num
9038
fdr peak number < bin_num * rank_lim
use rank for target
4.07681627548161
reference_pk_num
7709167
target_pk_num
9038
use FDR common peaks
use FDR common background
common peaks number:
15006
common background number:
6074930
check!!!
0
20.812981474077034
1.1000000000000143
Iteration 0 | dFB: 0.283029
[57.32757906233131, 1.716970916793128]
Iteration 10 | dFB: 0.001663
[6.297610886236292, 0.7577831379919314]
converged!
used: [A, B]
[6.2736828368002415, 0.7561298741972523]
transformation: B: 0.7561298741972523; A: 6.2736828368002415
User provide script_folder: -s /hpc/pmc_drost/nhung/S3norm/src/
User provide input_file_list: -t /hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/modify_bedgraph/s3norm_anti_SFPQ_Samples/anti_SFPQ_w_control.csv
User provide reference_method: -r mean
User provide NTmethod: -m mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000
User provide lowerlim: -b 0
User provide p_method: -p z
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
('Filelist is', '/hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/modify_bedgraph/s3norm_anti_SFPQ_Samples/anti_SFPQ_w_control.csv')
('script_folder is', '/hpc/pmc_drost/nhung/S3norm/src/')
Get average reference......
Get average reference......Done
Get S3norm normalized read counts......
Get S3norm normalized read counts......Done
Get signal track of negative log10 p-value based on a NB background model......
Get signal track of negative log10 p-value based on a NB background model......Done
Get NBP average reference......
Get NBP average reference......Done
Get S3norm normalized negative log10 p-value based on NB background model......
Get S3norm normalized negative log10 p-value based on NB background model......Done
Organize folder......
Save S3norm_NBP_bedgraph
Save S3norm_rc_bedgraph
Save NBP_bedgraph
Save average_ref_bedgraph
Organize folder......Done

real	8m28.190s
user	9m29.315s
sys	0m28.308s
finish cut and run analysis at Wed May 31 07:28:01 CEST 2023
