read first file name
get bed file
get first file signals
SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes2.bedgraph
get all file signals
SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes2.bedgraph
get average_ref
get reference mean
get output bedgraph file
User provide reference.bedgraph: -r average_ref.bedgraph
User provide target.bedgraph: -t SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes2.bedgraph
User provide outputname: -o SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes2.bedgraph
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p z
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
test
('sig1_raw[:,1] is', array(['54600', '54800', '55000', ..., '70200', '70400', '70600'],
      dtype='|S10'), 'sig2_raw[:,1] is', array(['54600', '54800', '55000', ..., '70200', '70400', '70600'],
      dtype='|S10'), 'bin_num is', 7807901)
('length sig1', 7807901)
('length sig2', 7807901)
check peak number in reference
reference_pk_num
626
check peak number in target
target_pk_num
672
fdr peak number < bin_num * rank_lim
use rank for reference
3.5
fdr peak number < bin_num * rank_lim
use rank for target
5.0
reference_pk_num
626
target_pk_num
672
use FDR common peaks
use FDR common background
common peaks number:
5558
common background number:
7795219
check!!!
6552450
Iteration 0 | dFB: 0.078280
[0.295406064467304, 1.9217196413421365]
Iteration 10 | dFB: 0.051839
[0.459495324600447, 1.2488347487068032]
Iteration 20 | dFB: 0.000318
[0.4966788710306988, 1.1168537434589483]
converged!
used: [A, B]
[0.49676766504566255, 1.116544741379502]
transformation: B: 1.116544741379502; A: 0.49676766504566255
User provide reference.bedgraph: -r average_ref.bedgraph
User provide target.bedgraph: -t SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes2.bedgraph
User provide outputname: -o SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes2.bedgraph
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p z
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
test
('sig1_raw[:,1] is', array(['54600', '54800', '55000', ..., '70200', '70400', '70600'],
      dtype='|S10'), 'sig2_raw[:,1] is', array(['54600', '54800', '55000', ..., '70200', '70400', '70600'],
      dtype='|S10'), 'bin_num is', 7807901)
('length sig1', 7807901)
('length sig2', 7807901)
check peak number in reference
reference_pk_num
626
check peak number in target
target_pk_num
869
fdr peak number < bin_num * rank_lim
use rank for reference
3.5
fdr peak number < bin_num * rank_lim
use rank for target
4.0
reference_pk_num
626
target_pk_num
869
use FDR common peaks
use FDR common background
common peaks number:
6522
common background number:
7775858
check!!!
6552450
Iteration 0 | dFB: 0.078785
[0.32645854342020203, 1.9212151978448104]
Iteration 10 | dFB: 0.048721
[0.47491636038320184, 1.2525117678401927]
Iteration 20 | dFB: 0.000230
[0.5032527611793489, 1.1409124706888925]
converged!
used: [A, B]
[0.5033104981941383, 1.1406888405641478]
transformation: B: 1.1406888405641478; A: 0.5033104981941383
[1] "args in R are"
[1] "SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes2.bedgraph.s3norm.bedgraph"             
[2] "bulkChIC-PMC-DRO-013_binsize_200_nozeroes2.bedgraph"                            
[3] "SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes2.bedgraph.s3norm.NB.neglog10p.bedgraph"
[1] "sig_raw in r script is"
    V1     V2     V3       V4
1 chr1  54600  54800 0.000000
2 chr1  54800  55000 0.000000
3 chr1  55000  55200 0.000000
4 chr1 128400 128600 0.000000
5 chr1 128600 128800 0.000000
6 chr1 629800 630000 1.077127
[1] "input_raw in r script is"
    V1     V2     V3 V4
1 chr1  54600  54800  1
2 chr1  54800  55000  1
3 chr1  55000  55200  1
4 chr1 128400 128600  1
5 chr1 128600 128800  2
6 chr1 629800 630000  0
[1] "head sig is"
[1] 0.000000 0.000000 0.000000 0.000000 0.000000 1.077127
[1] "min_non0 is"
[1] 1.077127
[1] "x in get_true_NB_prob_size is"
[1] "double"
[1] "numeric"
 num [1:323479] 1.08 1.08 1.08 1.08 1.08 ...
NULL
[1] "dim is"
[1] "head is"
[1] "m in gettrue is 1.07712666732113"
[1] "m2 in get true is 1.16020185745432"
[1] "p0 in get true is 0"
[1] "p in p is Inf"
[1] "1-p0 is 1"
[1] "m^2 is 1.16020185745432"
[1] "m2-m^2 is 0"
[1] "rt is Inf" "rt is NaN" "rt is 0"  
[1] "op os p0 before problematic comparison Inf NaN NaN"
[1] "p in problematic comparison is NaN"
[1] "1-p0 problematic comparison is NaN"
[1] "m^2  problematic comparison is 1.16020185745432"
[1] "m2-m^2 problematic comparison problematic comparison is 0"
[1] "p in  problematic comparison comparison is NaN"
Error in if (p < 0.001) { : missing value where TRUE/FALSE needed
Calls: get_true_NB_prob_size
Execution halted
[1] "args in R are"
[1] "SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes2.bedgraph.s3norm.bedgraph"             
[2] "bulkChIC-PMC-DRO-013_binsize_200_nozeroes2.bedgraph"                            
[3] "SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes2.bedgraph.s3norm.NB.neglog10p.bedgraph"
[1] "sig_raw in r script is"
    V1     V2     V3 V4
1 chr1  54600  54800  0
2 chr1  54800  55000  0
3 chr1  55000  55200  0
4 chr1 128400 128600  0
5 chr1 128600 128800  0
6 chr1 629800 630000  0
[1] "input_raw in r script is"
    V1     V2     V3 V4
1 chr1  54600  54800  1
2 chr1  54800  55000  1
3 chr1  55000  55200  1
4 chr1 128400 128600  1
5 chr1 128600 128800  2
6 chr1 629800 630000  0
[1] "head sig is"
[1] 0 0 0 0 0 0
[1] "min_non0 is"
[1] 1.109731
[1] "x in get_true_NB_prob_size is"
[1] "double"
[1] "numeric"
 num [1:318938] 1.11 1.11 1.11 1.11 1.11 ...
NULL
[1] "dim is"
[1] "head is"
[1] "m in gettrue is 1.10973055990778"
[1] "m2 in get true is 1.23150191559324"
[1] "p0 in get true is 0"
[1] "p in p is Inf"
[1] "1-p0 is 1"
[1] "m^2 is 1.23150191559324"
[1] "m2-m^2 is 0"
[1] "rt is Inf" "rt is NaN" "rt is 0"  
[1] "op os p0 before problematic comparison Inf NaN NaN"
[1] "p in problematic comparison is NaN"
[1] "1-p0 problematic comparison is NaN"
[1] "m^2  problematic comparison is 1.23150191559324"
[1] "m2-m^2 problematic comparison problematic comparison is 0"
[1] "p in  problematic comparison comparison is NaN"
Error in if (p < 0.001) { : missing value where TRUE/FALSE needed
Calls: get_true_NB_prob_size
Execution halted
read first file name
get bed file
cut: SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes2.bedgraph.s3norm.NB.neglog10p.bedgraph: No such file or directory
get first file signals
SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes2.bedgraph
get all file signals
SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes2.bedgraph
cut: SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes2.bedgraph.s3norm.NB.neglog10p.bedgraph: No such file or directory
get average_ref
get reference mean
get output bedgraph file
User provide reference.bedgraph: -r average_ref.bedgraph.NBP.bedgraph
User provide target.bedgraph: -t SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes2.bedgraph.s3norm.NB.neglog10p.bedgraph
User provide outputname: -o SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes2.bedgraph.NBP
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p neglog10p
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
User provide cross_mark: -c F
start S3norm.......
Traceback (most recent call last):
  File "/hpc/pmc_drost/nhung/S3norm/src//s3norm.py", line 477, in <module>
    main(sys.argv[1:])
  File "/hpc/pmc_drost/nhung/S3norm/src//s3norm.py", line 474, in main
    s3norm(sig1_wg_raw, sig2_wg_raw, sig2_output_name, NTmethod, B_init, fdr_thresh, rank_lim, upperlim, lowerlim, p_method, common_pk_binary, common_bg_binary, cross_mark)
  File "/hpc/pmc_drost/nhung/S3norm/src//s3norm.py", line 182, in s3norm
    sig2_raw = read2d_array(sig2_wg_raw, str)
  File "/hpc/pmc_drost/nhung/S3norm/src//s3norm.py", line 11, in read2d_array
    data=open(filename,'r')
IOError: [Errno 2] No such file or directory: 'SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes2.bedgraph.s3norm.NB.neglog10p.bedgraph'
User provide reference.bedgraph: -r average_ref.bedgraph.NBP.bedgraph
User provide target.bedgraph: -t SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes2.bedgraph.s3norm.NB.neglog10p.bedgraph
User provide outputname: -o SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes2.bedgraph.NBP
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p neglog10p
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
User provide cross_mark: -c F
start S3norm.......
Traceback (most recent call last):
  File "/hpc/pmc_drost/nhung/S3norm/src//s3norm.py", line 477, in <module>
    main(sys.argv[1:])
  File "/hpc/pmc_drost/nhung/S3norm/src//s3norm.py", line 474, in main
    s3norm(sig1_wg_raw, sig2_wg_raw, sig2_output_name, NTmethod, B_init, fdr_thresh, rank_lim, upperlim, lowerlim, p_method, common_pk_binary, common_bg_binary, cross_mark)
  File "/hpc/pmc_drost/nhung/S3norm/src//s3norm.py", line 182, in s3norm
    sig2_raw = read2d_array(sig2_wg_raw, str)
  File "/hpc/pmc_drost/nhung/S3norm/src//s3norm.py", line 11, in read2d_array
    data=open(filename,'r')
IOError: [Errno 2] No such file or directory: 'SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes2.bedgraph.s3norm.NB.neglog10p.bedgraph'
mv: cannot stat '*.NBP.info.txt': No such file or directory
mv: cannot stat '*.NBP.s3norm.bedgraph': No such file or directory
mv: cannot stat '*.s3norm.NB.neglog10p.bedgraph': No such file or directory
User provide script_folder: -s /hpc/pmc_drost/nhung/S3norm/src/
User provide input_file_list: -t /hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/bincount_bamcoverage_fixbinsize//nozeros_4file.txt
Default reference_method: -m max1
Default NTmethod: -m non0mean
Default B_init: -i 2.0
Default fdr_thresh: -f 0.05
Default rank_lim: -l 0.001
Default upperlim: -a 100000
Default lowerlim: -b 0
Default p_method: -p z
Default common_pk_binary: -k 0
Default common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
('Filelist is', '/hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/bincount_bamcoverage_fixbinsize//nozeros_4file.txt')
('script_folder is', '/hpc/pmc_drost/nhung/S3norm/src/')
Get average reference......
Get average reference......Done
Get S3norm normalized read counts......
Get S3norm normalized read counts......Done
Get signal track of negative log10 p-value based on a NB background model......
Get signal track of negative log10 p-value based on a NB background model......Done
Get NBP average reference......
Get NBP average reference......Done
Get S3norm normalized negative log10 p-value based on NB background model......
Get S3norm normalized negative log10 p-value based on NB background model......Done
Organize folder......
Save S3norm_NBP_bedgraph
Save S3norm_rc_bedgraph
Save NBP_bedgraph
Save average_ref_bedgraph
Organize folder......Done

real	3m30.953s
user	4m12.638s
sys	0m17.668s
