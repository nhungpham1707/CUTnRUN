start running cut and run analysis at Thu Jun  1 20:13:19 CEST 2023
-------------------step 7. running data normalization------ 
read first file name
get bed file
get first file signals
SCC-bulkChIC-PMC-DRO-022_nozeroes_augmented.bedgraph
get all file signals
SCC-bulkChIC-PMC-DRO-025_nozeroes_augmented.bedgraph
get average_ref
get reference mean
get output bedgraph file
User provide reference.bedgraph: -r average_ref.bedgraph
User provide target.bedgraph: -t SCC-bulkChIC-PMC-DRO-022_nozeroes_augmented.bedgraph
User provide outputname: -o SCC-bulkChIC-PMC-DRO-022_nozeroes_augmented.bedgraph
User provide NTmethod: -m mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p z
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
test
sig1_raw[:,1] is ['30600' '30800' '54400' ... '70600' '70800' '71000'] sig2_raw[:,1] is ['30600' '30800' '54400' ... '70600' '70800' '71000'] bin_num is 13784097
length sig1 13784097
length sig2 13784097
check peak number in reference
reference_pk_num
40374
check peak number in target
target_pk_num
59891
reference_pk_num
40374
target_pk_num
59891
use FDR common peaks
use FDR common background
common peaks number:
34427
common background number:
13718259
check!!!
5194554
27.196639265692635
2.7714188367488846
Iteration 0 | dFB: 0.113278
[0.20035262007968108, 1.8867216933264142]
Iteration 10 | dFB: 0.053150
[0.856888544106254, 1.0498231369443332]
Iteration 20 | dFB: 0.000166
[0.9919633236381991, 0.9485075071063379]
converged!
used: [A, B]
[0.9921891894754865, 0.9483460317798212]
transformation: B: 0.9483460317798212; A: 0.9921891894754865
User provide reference.bedgraph: -r average_ref.bedgraph
User provide target.bedgraph: -t SCC-bulkChIC-PMC-DRO-025_nozeroes_augmented.bedgraph
User provide outputname: -o SCC-bulkChIC-PMC-DRO-025_nozeroes_augmented.bedgraph
User provide NTmethod: -m mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p z
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
test
sig1_raw[:,1] is ['30600' '30800' '54400' ... '70600' '70800' '71000'] sig2_raw[:,1] is ['30600' '30800' '54400' ... '70600' '70800' '71000'] bin_num is 13784097
length sig1 13784097
length sig2 13784097
check peak number in reference
reference_pk_num
40374
check peak number in target
target_pk_num
33685
reference_pk_num
40374
target_pk_num
33685
use FDR common peaks
use FDR common background
common peaks number:
22415
common background number:
13732453
check!!!
5194554
30.06250278831141
2.7850327104705874
Iteration 0 | dFB: 0.103789
[0.2924164979704981, 1.8962105378415541]
Iteration 10 | dFB: 0.055276
[0.9505317896223907, 1.1159699971401402]
Iteration 20 | dFB: 0.000221
[1.1027193999266516, 0.997707218424853]
converged!
used: [A, B]
[1.1030075708227118, 0.9974930527113568]
transformation: B: 0.9974930527113568; A: 1.1030075708227118
[1] "args in R are"
[1] "SCC-bulkChIC-PMC-DRO-022_nozeroes_augmented.bedgraph.s3norm.bedgraph"             
[2] "SCC-bulkChIC-PMC-DRO-025_nozeroes_augmented.bedgraph"                             
[3] "SCC-bulkChIC-PMC-DRO-022_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph"
[1] "sig_raw in r script is"
    V1    V2    V3        V4
1 chr1 30600 30800 0.9921892
2 chr1 30800 31000 0.9921892
3 chr1 54400 54600 0.9921892
4 chr1 54600 54800 0.9921892
5 chr1 54800 55000 0.9921892
6 chr1 55000 55200 0.9921892
[1] "input_raw in r script is"
    V1    V2    V3 V4
1 chr1 30600 30800  1
2 chr1 30800 31000  1
3 chr1 54400 54600  1
4 chr1 54600 54800  1
5 chr1 54800 55000  1
6 chr1 55000 55200  1
[1] "head sig is"
[1] 0.9921892 0.9921892 0.9921892 0.9921892 0.9921892 0.9921892
[1] "min_non0 is"
[1] 1.914587
[1] "x in get_true_NB_prob_size is"
[1] "double"
[1] "numeric"
 num [1:7244126] 1.91 1.91 3.69 4.57 7.97 ...
NULL
[1] "dim is"
[1] "head is"
[1] "m in gettrue is 4.06755443689706"
[1] "m2 in get true is 22.4781657434503"
[1] "p0 in get true is 0"
[1] "p in p is 0.685562142336512"
[1] "1-p0 is 1"
[1] "m^2 is 16.5449990971209"
[1] "m2-m^2 is 5.9331666463293"
[1] "rt is 0.685562142336512" "rt is 8.86840202560425" 
[3] "rt is 0"                
[1] "op os p0 before problematic comparison 0.685562142336512 8.86840202560425 0.0351558295929612"
[1] "p in problematic comparison is 0.624354096087932"
[1] "1-p0 problematic comparison is 0.964844170407039"
[1] "m^2  problematic comparison is 16.5449990971209"
[1] "m2-m^2 problematic comparison problematic comparison is 5.9331666463293"
[1] "p in  problematic comparison comparison is 0.624354096087932"
[1] "op os p0 before problematic comparison 0.624354096087932 6.52293211425014 0.0463031006014522"
[1] "p in problematic comparison is 0.607165516207384"
[1] "1-p0 problematic comparison is 0.953696899398548"
[1] "m^2  problematic comparison is 16.5449990971209"
[1] "m2-m^2 problematic comparison problematic comparison is 5.9331666463293"
[1] "p in  problematic comparison comparison is 0.607165516207384"
[1] "op os p0 before problematic comparison 0.607165516207384 5.99571855607694 0.0502077022335021"
[1] "p in problematic comparison is 0.60136647206545"
[1] "1-p0 problematic comparison is 0.949792297766498"
[1] "m^2  problematic comparison is 16.5449990971209"
[1] "m2-m^2 problematic comparison problematic comparison is 5.9331666463293"
[1] "p in  problematic comparison comparison is 0.60136647206545"
[1] "op os p0 before problematic comparison 0.60136647206545 5.82810550851243 0.0516178629866869"
[1] "p in problematic comparison is 0.599299260384504"
[1] "1-p0 problematic comparison is 0.948382137013313"
[1] "m^2  problematic comparison is 16.5449990971209"
[1] "m2-m^2 problematic comparison problematic comparison is 5.9331666463293"
[1] "p in  problematic comparison comparison is 0.599299260384504"
[1] "op os p0 before problematic comparison 0.599299260384504 5.76952868485245 0.0521325765482606"
[1] "p in problematic comparison is 0.598548256994885"
[1] "1-p0 problematic comparison is 0.947867423451739"
[1] "m^2  problematic comparison is 16.5449990971209"
[1] "m2-m^2 problematic comparison problematic comparison is 5.9331666463293"
[1] "p in  problematic comparison comparison is 0.598548256994885"
[1] "op os p0 before problematic comparison 0.598548256994885 5.74839752961912 0.0523211669885997"
[1] "p in problematic comparison is 0.598273561188166"
[1] "1-p0 problematic comparison is 0.9476788330114"
[1] "m^2  problematic comparison is 16.5449990971209"
[1] "m2-m^2 problematic comparison problematic comparison is 5.9331666463293"
[1] "p in  problematic comparison comparison is 0.598273561188166"
[1] "op os p0 before problematic comparison 0.598273561188166 5.740688084835 0.0523903624764115"
[1] "p in problematic comparison is 0.598172836102034"
[1] "1-p0 problematic comparison is 0.947609637523589"
[1] "m^2  problematic comparison is 16.5449990971209"
[1] "m2-m^2 problematic comparison problematic comparison is 5.9331666463293"
[1] "p in  problematic comparison comparison is 0.598172836102034"
[1] "op os p0 before problematic comparison 0.598172836102034 5.73786383718797 0.0524157638433133"
[1] "p in problematic comparison is 0.598135868864718"
[1] "1-p0 problematic comparison is 0.947584236156687"
[1] "m^2  problematic comparison is 16.5449990971209"
[1] "m2-m^2 problematic comparison problematic comparison is 5.9331666463293"
[1] "p in  problematic comparison comparison is 0.598135868864718"
[1] "op os p0 before problematic comparison 0.598135868864718 5.73682766174813 0.052425090318729"
[1] "p in problematic comparison is 0.598122296961219"
[1] "1-p0 problematic comparison is 0.947574909681271"
[1] "m^2  problematic comparison is 16.5449990971209"
[1] "m2-m^2 problematic comparison problematic comparison is 5.9331666463293"
[1] "p in  problematic comparison comparison is 0.598122296961219"
[1] "op os p0 before problematic comparison 0.598122296961219 5.73644729508872 0.0524285149025444"
[1] "p in problematic comparison is 0.598117313655397"
[1] "1-p0 problematic comparison is 0.947571485097456"
[1] "m^2  problematic comparison is 16.5449990971209"
[1] "m2-m^2 problematic comparison problematic comparison is 5.9331666463293"
[1] "p in  problematic comparison comparison is 0.598117313655397"
[1] "op os p0 before problematic comparison 0.598117313655397 5.73630763922743 0.0524297724054197"
[1] "p in problematic comparison is 0.598115483812603"
[1] "1-p0 problematic comparison is 0.94757022759458"
[1] "m^2  problematic comparison is 16.5449990971209"
[1] "m2-m^2 problematic comparison problematic comparison is 5.9331666463293"
[1] "p in  problematic comparison comparison is 0.598115483812603"
[1] "op os p0 before problematic comparison 0.598115483812603 5.7362563592241 0.0524302341631656"
[1] "p in problematic comparison is 0.598114811893225"
[1] "1-p0 problematic comparison is 0.947569765836834"
[1] "m^2  problematic comparison is 16.5449990971209"
[1] "m2-m^2 problematic comparison problematic comparison is 5.9331666463293"
[1] "p in  problematic comparison comparison is 0.598114811893225"
[1] "op os p0 before problematic comparison 0.598114811893225 5.73623752929316 0.0524304037221735"
[1] "p in problematic comparison is 0.598114565162533"
[1] "1-p0 problematic comparison is 0.947569596277826"
[1] "m^2  problematic comparison is 16.5449990971209"
[1] "m2-m^2 problematic comparison problematic comparison is 5.9331666463293"
[1] "p in  problematic comparison comparison is 0.598114565162533"
[1] "summary negative log10 NB p-value:"
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.0000  0.2719  0.2846  0.3721 10.8638 
[1] "output_name in r script is"
[1] "SCC-bulkChIC-PMC-DRO-022_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph"
[1] "dim neglog10_nb_pval_bedgraph is 13784097"
[2] "dim neglog10_nb_pval_bedgraph is 4"       
[1] "head neglog10_nb_pval_bedgraph is"
    V1    V2    V3 neglog10_nb_pval
1 chr1 30600 30800                0
2 chr1 30800 31000                0
3 chr1 54400 54600                0
4 chr1 54600 54800                0
5 chr1 54800 55000                0
6 chr1 55000 55200                0
[1] "args in R are"
[1] "SCC-bulkChIC-PMC-DRO-025_nozeroes_augmented.bedgraph.s3norm.bedgraph"             
[2] "SCC-bulkChIC-PMC-DRO-022_nozeroes_augmented.bedgraph"                             
[3] "SCC-bulkChIC-PMC-DRO-025_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph"
[1] "sig_raw in r script is"
    V1    V2    V3       V4
1 chr1 30600 30800 1.103008
2 chr1 30800 31000 1.103008
3 chr1 54400 54600 1.103008
4 chr1 54600 54800 1.103008
5 chr1 54800 55000 1.103008
6 chr1 55000 55200 1.103008
[1] "input_raw in r script is"
    V1    V2    V3 V4
1 chr1 30600 30800  1
2 chr1 30800 31000  1
3 chr1 54400 54600  1
4 chr1 54600 54800  1
5 chr1 54800 55000  1
6 chr1 55000 55200  1
[1] "head sig is"
[1] 1.103008 1.103008 1.103008 1.103008 1.103008 1.103008
[1] "min_non0 is"
[1] 1.103008
[1] "x in get_true_NB_prob_size is"
[1] "double"
[1] "numeric"
 num [1:13659764] 1.1 1.1 1.1 1.1 1.1 ...
NULL
[1] "dim is"
[1] "head is"
[1] "m in gettrue is 2.60414629106818"
[1] "m2 in get true is 11.8575327522045"
[1] "p0 in get true is 0"
[1] "p in p is 0.513035747874739"
[1] "1-p0 is 1"
[1] "m^2 is 6.78157790528417"
[1] "m2-m^2 is 5.07595484692034"
[1] "rt is 0.513035747874739" "rt is 2.74356923364003" 
[3] "rt is 0"                
[1] "op os p0 before problematic comparison 0.513035747874739 2.74356923364003 0.160239635463632"
[1] "p in problematic comparison is 0.422570439755894"
[1] "1-p0 problematic comparison is 0.839760364536368"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.422570439755894"
[1] "op os p0 before problematic comparison 0.422570439755894 1.60037165530648 0.251941403782664"
[1] "p in problematic comparison is 0.383836759305179"
[1] "1-p0 problematic comparison is 0.748058596217336"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.383836759305179"
[1] "op os p0 before problematic comparison 0.383836759305179 1.21353351215854 0.312858471502507"
[1] "p in problematic comparison is 0.361806132416746"
[1] "1-p0 problematic comparison is 0.687141528497493"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.361806132416746"
[1] "op os p0 before problematic comparison 0.361806132416746 1.01445986820787 0.35652627665597"
[1] "p in problematic comparison is 0.34750837448352"
[1] "1-p0 problematic comparison is 0.64347372334403"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.34750837448352"
[1] "op os p0 before problematic comparison 0.34750837448352 0.892455411821911 0.389342645443431"
[1] "p in problematic comparison is 0.337485858540693"
[1] "1-p0 problematic comparison is 0.610657354556569"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.337485858540693"
[1] "op os p0 before problematic comparison 0.337485858540693 0.810071580766092 0.41481385309783"
[1] "p in problematic comparison is 0.330096422221005"
[1] "1-p0 problematic comparison is 0.58518614690217"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.330096422221005"
[1] "op os p0 before problematic comparison 0.330096422221005 0.750910079805692 0.435053370515665"
[1] "p in problematic comparison is 0.324451523354299"
[1] "1-p0 problematic comparison is 0.564946629484335"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.324451523354299"
[1] "op os p0 before problematic comparison 0.324451523354299 0.706587740688349 0.451423801891927"
[1] "p in problematic comparison is 0.32002503553688"
[1] "1-p0 problematic comparison is 0.548576198108073"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.32002503553688"
[1] "op os p0 before problematic comparison 0.32002503553688 0.672346842033564 0.464849099948644"
[1] "p in problematic comparison is 0.316484042396019"
[1] "1-p0 problematic comparison is 0.535150900051355"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.316484042396019"
[1] "op os p0 before problematic comparison 0.316484042396019 0.645274936417534 0.47598092708511"
[1] "p in problematic comparison is 0.313606848130534"
[1] "1-p0 problematic comparison is 0.52401907291489"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.313606848130534"
[1] "op os p0 before problematic comparison 0.313606848130534 0.623483647997904 0.485293660244747"
[1] "p in problematic comparison is 0.31123971283887"
[1] "1-p0 problematic comparison is 0.514706339755253"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.31123971283887"
[1] "op os p0 before problematic comparison 0.31123971283887 0.605691951438825 0.493141696579524"
[1] "p in problematic comparison is 0.309272448941932"
[1] "1-p0 problematic comparison is 0.506858303420476"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.309272448941932"
[1] "op os p0 before problematic comparison 0.309272448941932 0.590998525531431 0.499795590664252"
[1] "p in problematic comparison is 0.307623897269177"
[1] "1-p0 problematic comparison is 0.500204409335748"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.307623897269177"
[1] "op os p0 before problematic comparison 0.307623897269177 0.578749852591554 0.505465700526161"
[1] "p in problematic comparison is 0.306232892057849"
[1] "1-p0 problematic comparison is 0.494534299473839"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.306232892057849"
[1] "op os p0 before problematic comparison 0.306232892057849 0.568460020112141 0.510318151789795"
[1] "p in problematic comparison is 0.305052427693512"
[1] "1-p0 problematic comparison is 0.489681848210205"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.305052427693512"
[1] "op os p0 before problematic comparison 0.305052427693512 0.559759955934411 0.514485909219426"
[1] "p in problematic comparison is 0.304045771279343"
[1] "1-p0 problematic comparison is 0.485514090780574"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.304045771279343"
[1] "op os p0 before problematic comparison 0.304045771279343 0.552364177908899 0.518076636931148"
[1] "p in problematic comparison is 0.303183799970263"
[1] "1-p0 problematic comparison is 0.481923363068852"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.303183799970263"
[1] "op os p0 before problematic comparison 0.303183799970263 0.546048365582406 0.521178394855387"
[1] "p in problematic comparison is 0.302443132965491"
[1] "1-p0 problematic comparison is 0.478821605144613"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.302443132965491"
[1] "op os p0 before problematic comparison 0.302443132965491 0.540633839329644 0.523863843308594"
[1] "p in problematic comparison is 0.301804792966025"
[1] "1-p0 problematic comparison is 0.476136156691406"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.301804792966025"
[1] "op os p0 before problematic comparison 0.301804792966025 0.535976574864481 0.526193397647184"
[1] "p in problematic comparison is 0.301253228771613"
[1] "1-p0 problematic comparison is 0.473806602352816"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.301253228771613"
[1] "op os p0 before problematic comparison 0.301253228771613 0.531959270734321 0.52821763037187"
[1] "p in problematic comparison is 0.300775589402553"
[1] "1-p0 problematic comparison is 0.47178236962813"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.300775589402553"
[1] "op os p0 before problematic comparison 0.300775589402553 0.5284855168669 0.529979124826111"
[1] "p in problematic comparison is 0.300361176716694"
[1] "1-p0 problematic comparison is 0.470020875173889"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.300361176716694"
[1] "op os p0 before problematic comparison 0.300361176716694 0.525475437948095 0.531513923196725"
[1] "p in problematic comparison is 0.30000102686075"
[1] "1-p0 problematic comparison is 0.468486076803275"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.30000102686075"
[1] "op os p0 before problematic comparison 0.30000102686075 0.522862390686756 0.532852670229922"
[1] "p in problematic comparison is 0.299687586156851"
[1] "1-p0 problematic comparison is 0.467147329770078"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.299687586156851"
[1] "op os p0 before problematic comparison 0.299687586156851 0.520590426458504 0.53402152581821"
[1] "p in problematic comparison is 0.299414457194223"
[1] "1-p0 problematic comparison is 0.46597847418179"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.299414457194223"
[1] "op os p0 before problematic comparison 0.299414457194223 0.518612318080464 0.535042899960062"
[1] "p in problematic comparison is 0.299176197795717"
[1] "1-p0 problematic comparison is 0.464957100039938"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.299176197795717"
[1] "op os p0 before problematic comparison 0.299176197795717 0.516888008069814 0.535936049720193"
[1] "p in problematic comparison is 0.298968160288625"
[1] "1-p0 problematic comparison is 0.464063950279807"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.298968160288625"
[1] "op os p0 before problematic comparison 0.298968160288625 0.515383375781739 0.53671756788972"
[1] "p in problematic comparison is 0.298786361842811"
[1] "1-p0 problematic comparison is 0.46328243211028"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.298786361842811"
[1] "op os p0 before problematic comparison 0.298786361842811 0.514069248621082 0.537401785850163"
[1] "p in problematic comparison is 0.298627379006618"
[1] "1-p0 problematic comparison is 0.462598214149837"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.298627379006618"
[1] "op os p0 before problematic comparison 0.298627379006618 0.512920602102981 0.538001107869572"
[1] "p in problematic comparison is 0.298488261274077"
[1] "1-p0 problematic comparison is 0.461998892130428"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.298488261274077"
[1] "op os p0 before problematic comparison 0.298488261274077 0.511915907516465 0.538526290148488"
[1] "p in problematic comparison is 0.298366459756776"
[1] "1-p0 problematic comparison is 0.461473709851512"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.298366459756776"
[1] "op os p0 before problematic comparison 0.298366459756776 0.511036596048595 0.538986675005009"
[1] "p in problematic comparison is 0.298259767946411"
[1] "1-p0 problematic comparison is 0.461013324994991"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.298259767946411"
[1] "op os p0 before problematic comparison 0.298259767946411 0.510266615614111 0.539390388374174"
[1] "p in problematic comparison is 0.298166272232867"
[1] "1-p0 problematic comparison is 0.460609611625826"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.298166272232867"
[1] "op os p0 before problematic comparison 0.298166272232867 0.509592062095316 0.539744507107586"
[1] "p in problematic comparison is 0.298084310352571"
[1] "1-p0 problematic comparison is 0.460255492892414"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.298084310352571"
[1] "op os p0 before problematic comparison 0.298084310352571 0.509000870772984 0.54005520125917"
[1] "p in problematic comparison is 0.298012436328387"
[1] "1-p0 problematic comparison is 0.45994479874083"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.298012436328387"
[1] "op os p0 before problematic comparison 0.298012436328387 0.508482556801178 0.540327855534204"
[1] "p in problematic comparison is 0.297949390757918"
[1] "1-p0 problematic comparison is 0.459672144465796"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297949390757918"
[1] "op os p0 before problematic comparison 0.297949390757918 0.508027995915163 0.540567173289853"
[1] "p in problematic comparison is 0.297894075535019"
[1] "1-p0 problematic comparison is 0.459432826710147"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297894075535019"
[1] "op os p0 before problematic comparison 0.297894075535019 0.507629238353706 0.540777265853738"
[1] "p in problematic comparison is 0.297845532266517"
[1] "1-p0 problematic comparison is 0.459222734146262"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297845532266517"
[1] "op os p0 before problematic comparison 0.297845532266517 0.507279350362889 0.540961729433617"
[1] "p in problematic comparison is 0.297802923784949"
[1] "1-p0 problematic comparison is 0.459038270566383"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297802923784949"
[1] "op os p0 before problematic comparison 0.297802923784949 0.506972278728771 0.54112371149681"
[1] "p in problematic comparison is 0.29776551826762"
[1] "1-p0 problematic comparison is 0.45887628850319"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.29776551826762"
[1] "op os p0 before problematic comparison 0.29776551826762 0.506702734634468 0.541265968180588"
[1] "p in problematic comparison is 0.297732675559358"
[1] "1-p0 problematic comparison is 0.458734031819412"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297732675559358"
[1] "op os p0 before problematic comparison 0.297732675559358 0.506466093808249 0.541390914037644"
[1] "p in problematic comparison is 0.297703835365987"
[1] "1-p0 problematic comparison is 0.458609085962356"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297703835365987"
[1] "op os p0 before problematic comparison 0.297703835365987 0.50625831046371 0.541500665211284"
[1] "p in problematic comparison is 0.297678507041617"
[1] "1-p0 problematic comparison is 0.458499334788716"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297678507041617"
[1] "op os p0 before problematic comparison 0.297678507041617 0.506075842961754 0.541597076963171"
[1] "p in problematic comparison is 0.297656260738386"
[1] "1-p0 problematic comparison is 0.458402923036829"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297656260738386"
[1] "op os p0 before problematic comparison 0.297656260738386 0.505915589470072 0.54168177633489"
[1] "p in problematic comparison is 0.297636719724307"
[1] "1-p0 problematic comparison is 0.45831822366511"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297636719724307"
[1] "op os p0 before problematic comparison 0.297636719724307 0.505774832176864 0.541756190607177"
[1] "p in problematic comparison is 0.297619553705372"
[1] "1-p0 problematic comparison is 0.458243809392823"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297619553705372"
[1] "op os p0 before problematic comparison 0.297619553705372 0.505651188845161 0.541821572122932"
[1] "p in problematic comparison is 0.297604473013109"
[1] "1-p0 problematic comparison is 0.458178427877068"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297604473013109"
[1] "op os p0 before problematic comparison 0.297604473013109 0.505542570682824 0.541879019958219"
[1] "p in problematic comparison is 0.29759122353965"
[1] "1-p0 problematic comparison is 0.458120980041781"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.29759122353965"
[1] "op os p0 before problematic comparison 0.29759122353965 0.505447145659256 0.541929498856677"
[1] "p in problematic comparison is 0.297579582319679"
[1] "1-p0 problematic comparison is 0.458070501143323"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297579582319679"
[1] "op os p0 before problematic comparison 0.297579582319679 0.505363306529387 0.541973855784636"
[1] "p in problematic comparison is 0.297569353673182"
[1] "1-p0 problematic comparison is 0.458026144215364"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297569353673182"
[1] "op os p0 before problematic comparison 0.297569353673182 0.505289642933614 0.542012834414982"
[1] "p in problematic comparison is 0.297560365835143"
[1] "1-p0 problematic comparison is 0.457987165585018"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297560365835143"
[1] "op os p0 before problematic comparison 0.297560365835143 0.505224917033066 0.542047087805903"
[1] "p in problematic comparison is 0.297552468008633"
[1] "1-p0 problematic comparison is 0.457952912194097"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297552468008633"
[1] "op os p0 before problematic comparison 0.297552468008633 0.505168042215927 0.542077189504903"
[1] "p in problematic comparison is 0.297545527786513"
[1] "1-p0 problematic comparison is 0.457922810495097"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297545527786513"
[1] "op os p0 before problematic comparison 0.297545527786513 0.505118064475123 0.542103643277848"
[1] "p in problematic comparison is 0.297539428894394"
[1] "1-p0 problematic comparison is 0.457896356722152"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297539428894394"
[1] "op os p0 before problematic comparison 0.297539428894394 0.505074146112519 0.542126891636531"
[1] "p in problematic comparison is 0.297534069213886"
[1] "1-p0 problematic comparison is 0.457873108363469"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297534069213886"
[1] "op os p0 before problematic comparison 0.297534069213886 0.505035551471437 0.542147323315626"
[1] "p in problematic comparison is 0.297529359050577"
[1] "1-p0 problematic comparison is 0.457852676684374"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297529359050577"
[1] "op os p0 before problematic comparison 0.297529359050577 0.505001634439224 0.542165279830399"
[1] "p in problematic comparison is 0.297525219615878"
[1] "1-p0 problematic comparison is 0.457834720169601"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297525219615878"
[1] "op os p0 before problematic comparison 0.297525219615878 0.504971827495779 0.542181061229677"
[1] "p in problematic comparison is 0.297521581695881"
[1] "1-p0 problematic comparison is 0.457818938770323"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297521581695881"
[1] "op os p0 before problematic comparison 0.297521581695881 0.504945632113328 0.542194931143984"
[1] "p in problematic comparison is 0.297518384483863"
[1] "1-p0 problematic comparison is 0.457805068856016"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297518384483863"
[1] "op os p0 before problematic comparison 0.297518384483863 0.504922610338038 0.542207121216093"
[1] "p in problematic comparison is 0.297515574556038"
[1] "1-p0 problematic comparison is 0.457792878783907"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297515574556038"
[1] "op os p0 before problematic comparison 0.297515574556038 0.504902377405905 0.542217834990221"
[1] "p in problematic comparison is 0.297513104972796"
[1] "1-p0 problematic comparison is 0.457782165009779"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297513104972796"
[1] "op os p0 before problematic comparison 0.297513104972796 0.504884595264248 0.542227251326557"
[1] "p in problematic comparison is 0.297510934489876"
[1] "1-p0 problematic comparison is 0.457772748673443"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297510934489876"
[1] "op os p0 before problematic comparison 0.297510934489876 0.504868966886496 0.542235527399467"
[1] "p in problematic comparison is 0.297509026865931"
[1] "1-p0 problematic comparison is 0.457764472600533"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297509026865931"
[1] "op os p0 before problematic comparison 0.297509026865931 0.504855231282185 0.542242801330441"
[1] "p in problematic comparison is 0.297507350254587"
[1] "1-p0 problematic comparison is 0.457757198669559"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297507350254587"
[1] "op os p0 before problematic comparison 0.297507350254587 0.504843159116401 0.542249194500539"
[1] "p in problematic comparison is 0.297505876670626"
[1] "1-p0 problematic comparison is 0.457750805499461"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297505876670626"
[1] "op os p0 before problematic comparison 0.297505876670626 0.504832548863669 0.542254813581526"
[1] "p in problematic comparison is 0.297504581521204"
[1] "1-p0 problematic comparison is 0.457745186418474"
[1] "m^2  problematic comparison is 6.78157790528417"
[1] "m2-m^2 problematic comparison problematic comparison is 5.07595484692034"
[1] "p in  problematic comparison comparison is 0.297504581521204"
[1] "summary negative log10 NB p-value:"
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
  0.0000   0.0000   0.0000   0.2769   0.4478 172.2411 
[1] "output_name in r script is"
[1] "SCC-bulkChIC-PMC-DRO-025_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph"
[1] "dim neglog10_nb_pval_bedgraph is 13784097"
[2] "dim neglog10_nb_pval_bedgraph is 4"       
[1] "head neglog10_nb_pval_bedgraph is"
    V1    V2    V3 neglog10_nb_pval
1 chr1 30600 30800                0
2 chr1 30800 31000                0
3 chr1 54400 54600                0
4 chr1 54600 54800                0
5 chr1 54800 55000                0
6 chr1 55000 55200                0
read first file name
get bed file
get first file signals
SCC-bulkChIC-PMC-DRO-022_nozeroes_augmented.bedgraph
get all file signals
SCC-bulkChIC-PMC-DRO-025_nozeroes_augmented.bedgraph
get average_ref
get reference mean
get output bedgraph file
User provide reference.bedgraph: -r average_ref.bedgraph.NBP.bedgraph
User provide target.bedgraph: -t SCC-bulkChIC-PMC-DRO-022_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph
User provide outputname: -o SCC-bulkChIC-PMC-DRO-022_nozeroes_augmented.bedgraph.NBP
User provide NTmethod: -m mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p neglog10p
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
User provide cross_mark: -c F
start S3norm.......
test
sig1_raw[:,1] is ['30600' '30800' '54400' ... '70600' '70800' '71000'] sig2_raw[:,1] is ['30600' '30800' '54400' ... '70600' '70800' '71000'] bin_num is 13784097
length sig1 13784097
length sig2 13784097
check peak number in reference
reference_pk_num
4170882
check peak number in target
target_pk_num
446
fdr peak number < bin_num * rank_lim
use rank for target
3.3162725325433
reference_pk_num
4170882
target_pk_num
446
use FDR common peaks
use FDR common background
common peaks number:
15403
common background number:
9613215
check!!!
0
8.876733407777703
0.9191573745758309
Iteration 0 | dFB: 0.326295
[9.726083912622999, 1.6737047560817453]
Iteration 10 | dFB: 0.001559
[3.158188666001125, 0.7533485912946338]
converged!
used: [A, B]
[3.151139436086487, 0.7517965949912905]
transformation: B: 0.7517965949912905; A: 3.151139436086487
User provide reference.bedgraph: -r average_ref.bedgraph.NBP.bedgraph
User provide target.bedgraph: -t SCC-bulkChIC-PMC-DRO-025_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph
User provide outputname: -o SCC-bulkChIC-PMC-DRO-025_nozeroes_augmented.bedgraph.NBP
User provide NTmethod: -m mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p neglog10p
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
User provide cross_mark: -c F
start S3norm.......
test
sig1_raw[:,1] is ['30600' '30800' '54400' ... '70600' '70800' '71000'] sig2_raw[:,1] is ['30600' '30800' '54400' ... '70600' '70800' '71000'] bin_num is 13784097
length sig1 13784097
length sig2 13784097
check peak number in reference
reference_pk_num
4170882
check peak number in target
target_pk_num
83
fdr peak number < bin_num * rank_lim
use rank for target
2.53333587130713
reference_pk_num
4170882
target_pk_num
83
use FDR common peaks
use FDR common background
common peaks number:
13124
common background number:
9611999
check!!!
0
9.157270999695214
0.9190375061330108
Iteration 0 | dFB: 0.137183
[4.718089608857183, 1.8628169534893604]
Iteration 10 | dFB: 0.005694
[3.0105994076262004, 0.9613263897380189]
Iteration 20 | dFB: 0.000006
[2.9967859036682873, 0.9556106255626454]
converged!
used: [A, B]
[2.9967859036682873, 0.9556106255626454]
transformation: B: 0.9556106255626454; A: 2.9967859036682873
User provide script_folder: -s /hpc/pmc_drost/nhung/S3norm/src/
User provide input_file_list: -t /hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/modify_bedgraph/s3norm_anti_H3k27ac_Samples/anti_H3k27ac_w_control.csv
User provide reference_method: -r mean
User provide NTmethod: -m mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000
User provide lowerlim: -b 0
User provide p_method: -p z
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
Filelist is /hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/modify_bedgraph/s3norm_anti_H3k27ac_Samples/anti_H3k27ac_w_control.csv
script_folder is /hpc/pmc_drost/nhung/S3norm/src/
Get average reference......
Get average reference......Done
Get S3norm normalized read counts......
Get S3norm normalized read counts......Done
Get signal track of negative log10 p-value based on a NB background model......
Get signal track of negative log10 p-value based on a NB background model......Done
Get NBP average reference......
Get NBP average reference......Done
Get S3norm normalized negative log10 p-value based on NB background model......
Get S3norm normalized negative log10 p-value based on NB background model......Done
Organize folder......
Save S3norm_NBP_bedgraph
Save S3norm_rc_bedgraph
Save NBP_bedgraph
Save average_ref_bedgraph
Organize folder......Done

real	23m11.702s
user	21m34.443s
sys	1m18.938s
finish cut and run analysis at Thu Jun  1 20:36:30 CEST 2023
