read first file name
get bed file
get first file signals
SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes.bedgraph
get all file signals
SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes.bedgraph
get average_ref
get reference mean
get output bedgraph file
User provide reference.bedgraph: -r average_ref.bedgraph
User provide target.bedgraph: -t SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes.bedgraph
User provide outputname: -o SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes.bedgraph
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p z
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
test
('sig1_raw[:,1] is', array(['898400', '1165600', '1165800', ..., '66400', '66600', '66800'],
      dtype='|S10'), 'sig2_raw[:,1] is', array(['898400', '1165600', '1165800', ..., '66400', '66600', '66800'],
      dtype='|S10'), 'bin_num is', 65788)
('length sig1', 65788)
('length sig2', 65788)
check peak number in reference
reference_pk_num
53
check peak number in target
target_pk_num
53
fdr peak number < bin_num * rank_lim
use rank for reference
58.5
fdr peak number < bin_num * rank_lim
use rank for target
61.0
reference_pk_num
53
target_pk_num
53
use FDR common peaks
use FDR common background
common peaks number:
62
common background number:
65720
check!!!
27354
Iteration 0 | dFB: 0.074977
[0.2507149209636273, 1.9250230011719816]
Iteration 10 | dFB: 0.060800
[0.7507832259291425, 1.2400555048468074]
Iteration 20 | dFB: 0.001582
[1.007272750895365, 0.9920647680422751]
converged!
used: [A, B]
[1.0090539052935805, 0.9904484791034982]
transformation: B: 0.9904484791034982; A: 1.0090539052935805
User provide reference.bedgraph: -r average_ref.bedgraph
User provide target.bedgraph: -t SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes.bedgraph
User provide outputname: -o SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes.bedgraph
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p z
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
test
('sig1_raw[:,1] is', array(['898400', '1165600', '1165800', ..., '66400', '66600', '66800'],
      dtype='|S10'), 'sig2_raw[:,1] is', array(['898400', '1165600', '1165800', ..., '66400', '66600', '66800'],
      dtype='|S10'), 'bin_num is', 65788)
('length sig1', 65788)
('length sig2', 65788)
check peak number in reference
reference_pk_num
53
check peak number in target
target_pk_num
54
fdr peak number < bin_num * rank_lim
use rank for reference
58.5
fdr peak number < bin_num * rank_lim
use rank for target
54.0
reference_pk_num
53
target_pk_num
54
use FDR common peaks
use FDR common background
common peaks number:
62
common background number:
65720
check!!!
27354
Iteration 0 | dFB: 0.075696
[0.25787213048180263, 1.9243041545947648]
Iteration 10 | dFB: 0.059957
[0.7586785681610329, 1.2366157424100883]
Iteration 20 | dFB: 0.001184
[0.9893753392518668, 1.0113392013894558]
converged!
used: [A, B]
[0.9906756782119762, 1.0101419086149237]
transformation: B: 1.0101419086149237; A: 0.9906756782119762
[1] "args in R are"
[1] "SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes.bedgraph.s3norm.bedgraph"             
[2] "bulkChIC-PMC-DRO-013_binsize_200_nozeroes.bedgraph"                            
[3] "SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes.bedgraph.s3norm.NB.neglog10p.bedgraph"
[1] "sig_raw in r script is"
    V1      V2      V3       V4
1 chr1  898400  898600 2.004791
2 chr1 1165600 1165800 2.004791
3 chr1 1165800 1166000 1.009054
4 chr1 1270800 1271000 5.951591
5 chr1 1402200 1402400 2.004791
6 chr1 1402400 1402600 1.009054
[1] "input_raw in r script is"
    V1      V2      V3 V4
1 chr1  898400  898600  2
2 chr1 1165600 1165800 76
3 chr1 1165800 1166000 58
4 chr1 1270800 1271000 83
5 chr1 1402200 1402400 81
6 chr1 1402400 1402600 45
[1] "head sig is"
[1] 2.004791 2.004791 1.009054 5.951591 2.004791 1.009054
[1] "min_non0 is"
[1] 1.009054
[1] "unique values of sig are"
  [1]    2.004791    1.009054    5.951591    8.892880    4.968304    3.983123
  [7]    2.995563    7.913680    9.871039    6.933307   16.695931   10.848262
 [13]   13.775112   11.824636   21.553354   14.749326   46.676383   25.431535
 [19]   20.582800   28.336372   32.205066   18.640344   17.668395   15.722919
 [25]   31.238335   19.611804   12.800233   22.523487   34.137697   58.221256
 [31]   37.034683   23.493217   33.171517   30.271315   65.905253   26.400152
 [37]   52.451889  102.299964   27.368427   90.823001   50.527437   24.462561
 [43]   62.064402   37.999850   41.858216   94.650128   48.602278   35.103613
 [49]   53.413858   55.337298   38.964782   29.303997   36.069272   42.822259
 [55]   39.929483   43.786092   49.564948   45.713150  268.677821  362.290634
 [61]  532.868996  341.510395  181.398002   99.431945   71.662521   54.375660
 [67]  123.309710  306.533868 1131.578662  434.934965  155.713101  326.389869
 [73]  600.565543 1111.029395  928.719251 1018.511283  870.684494  213.692533
 [79]   63.024824   60.143125   59.182266   69.743946  249.730900  739.496605
 [85]  956.787894 1083.936113 1353.667037  518.755432  405.703828  280.039730
 [91]  689.775936  171.889451  216.539680  186.150459  315.045056  981.107620
 [97] 2738.553923 1482.275928  504.638164  284.772536  126.171859  241.200321
[103] 1392.820858 1898.160631  922.168733  790.122253  896.898215  836.969916
[109]  812.612380  542.276031 1361.125740 2475.430135 2330.784179 1205.340011
[115]  355.680019  384.003151  318.827091
[1] "x in get_true_NB_prob_size is"
[1] "double"
[1] "numeric"
 num [1:65210] 2 2 1.01 5.95 2 ...
NULL
[1] "dim is"
[1] "head is"
[1] "m in gettrue is 2.13252733788709"
[1] "m2 in get true is 6.98040962880029"
[1] "p0 in get true is 0"
[1] "p in p is 0.876596002369399"
[1] "1-p0 is 1"
[1] "m^2 is 4.54767284683578"
[1] "m2-m^2 is 2.43273678196451"
[1] "rt is 0.876596002369399" "rt is 15.1483337268461" 
[3] "rt is 0"                
[1] "op os p0 before problematic comparison 0.876596002369399 15.1483337268461 0.13599017135653"
[1] "p in problematic comparison is 0.698919899497982"
[1] "1-p0 problematic comparison is 0.86400982864347"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.698919899497982"
[1] "op os p0 before problematic comparison 0.698919899497982 4.27719099329017 0.216065934959062"
[1] "p in problematic comparison is 0.624397894372119"
[1] "1-p0 problematic comparison is 0.783934065040938"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.624397894372119"
[1] "op os p0 before problematic comparison 0.624397894372119 2.77912163765543 0.270123540854517"
[1] "p in problematic comparison is 0.582471499080909"
[1] "1-p0 problematic comparison is 0.729876459145483"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.582471499080909"
[1] "op os p0 before problematic comparison 0.582471499080909 2.17136342070923 0.309261619417362"
[1] "p in problematic comparison is 0.555467538129815"
[1] "1-p0 problematic comparison is 0.690738380582638"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.555467538129815"
[1] "op os p0 before problematic comparison 0.555467538129815 1.84061687018035 0.338855442437525"
[1] "p in problematic comparison is 0.536654910021659"
[1] "1-p0 problematic comparison is 0.661144557562475"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.536654910021659"
[1] "op os p0 before problematic comparison 0.536654910021659 1.63298267275 0.36190684200714"
[1] "p in problematic comparison is 0.522861437134016"
[1] "1-p0 problematic comparison is 0.63809315799286"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.522861437134016"
[1] "op os p0 before problematic comparison 0.522861437134016 1.49114813379204 0.380253064209972"
[1] "p in problematic comparison is 0.512380018818701"
[1] "1-p0 problematic comparison is 0.619746935790028"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.512380018818701"
[1] "op os p0 before problematic comparison 0.512380018818701 1.38873597953905 0.395093804019477"
[1] "p in problematic comparison is 0.504203874989048"
[1] "1-p0 problematic comparison is 0.604906195980523"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.504203874989048"
[1] "op os p0 before problematic comparison 0.504203874989048 1.31185456589057 0.407251373919852"
[1] "p in problematic comparison is 0.497697885501205"
[1] "1-p0 problematic comparison is 0.592748626080148"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.497697885501205"
[1] "op os p0 before problematic comparison 0.497697885501205 1.252466021373 0.417311118352215"
[1] "p in problematic comparison is 0.492440125192159"
[1] "1-p0 problematic comparison is 0.582688881647785"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.492440125192159"
[1] "op os p0 before problematic comparison 0.492440125192159 1.2055840403532 0.425702508009256"
[1] "p in problematic comparison is 0.488138574384005"
[1] "1-p0 problematic comparison is 0.574297491990744"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.488138574384005"
[1] "op os p0 before problematic comparison 0.488138574384005 1.16794462815739 0.432748548607589"
[1] "p in problematic comparison is 0.484584289724603"
[1] "1-p0 problematic comparison is 0.567251451392411"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.484584289724603"
[1] "op os p0 before problematic comparison 0.484584289724603 1.13731796992359 0.438697223013267"
[1] "p in problematic comparison is 0.481623606778541"
[1] "1-p0 problematic comparison is 0.561302776986733"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.481623606778541"
[1] "op os p0 before problematic comparison 0.481623606778541 1.1121269069526 0.443742237480456"
[1] "p in problematic comparison is 0.479140885194584"
[1] "1-p0 problematic comparison is 0.556257762519544"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.479140885194584"
[1] "op os p0 before problematic comparison 0.479140885194584 1.09122335949181 0.448037136932478"
[1] "p in problematic comparison is 0.477047388104502"
[1] "1-p0 problematic comparison is 0.551962863067522"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.477047388104502"
[1] "op os p0 before problematic comparison 0.477047388104502 1.07375117464356 0.451705165587446"
[1] "p in problematic comparison is 0.475273881549718"
[1] "1-p0 problematic comparison is 0.548294834412554"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.475273881549718"
[1] "op os p0 before problematic comparison 0.475273881549718 1.05905869022953 0.45484631569859"
[1] "p in problematic comparison is 0.473765571085598"
[1] "1-p0 problematic comparison is 0.54515368430141"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.473765571085598"
[1] "op os p0 before problematic comparison 0.473765571085598 1.04664113035344 0.457542469407553"
[1] "p in problematic comparison is 0.472478552403051"
[1] "1-p0 problematic comparison is 0.542457530592447"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.472478552403051"
[1] "op os p0 before problematic comparison 0.472478552403051 1.0361015594382 0.459861217727102"
[1] "p in problematic comparison is 0.47137726935358"
[1] "1-p0 problematic comparison is 0.540138782272898"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.47137726935358"
[1] "op os p0 before problematic comparison 0.47137726935358 1.02712374843593 0.461858743061982"
[1] "p in problematic comparison is 0.470432658343079"
[1] "1-p0 problematic comparison is 0.538141256938018"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.470432658343079"
[1] "op os p0 before problematic comparison 0.470432658343079 1.01945289942469 0.463582026662702"
[1] "p in problematic comparison is 0.469620770342494"
[1] "1-p0 problematic comparison is 0.536417973337298"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.469620770342494"
[1] "op os p0 before problematic comparison 0.469620770342494 1.01288168136242 0.465070561383338"
[1] "p in problematic comparison is 0.468921731620854"
[1] "1-p0 problematic comparison is 0.534929438616662"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.468921731620854"
[1] "op os p0 before problematic comparison 0.468921731620854 1.00723993375346 0.466357696454431"
[1] "p in problematic comparison is 0.468318948862437"
[1] "1-p0 problematic comparison is 0.533642303545569"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.468318948862437"
[1] "op os p0 before problematic comparison 0.468318948862437 1.00238695301529 0.467471704746682"
[1] "p in problematic comparison is 0.467798493389293"
[1] "1-p0 problematic comparison is 0.532528295253318"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.467798493389293"
[1] "op os p0 before problematic comparison 0.467798493389293 0.998205629634944 0.468436638097729"
[1] "p in problematic comparison is 0.467348618547886"
[1] "1-p0 problematic comparison is 0.531563361902271"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.467348618547886"
[1] "op os p0 before problematic comparison 0.467348618547886 0.994597933025377 0.469273018882358"
[1] "p in problematic comparison is 0.466959377423466"
[1] "1-p0 problematic comparison is 0.530726981117642"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.466959377423466"
[1] "op os p0 before problematic comparison 0.466959377423466 0.99148139225756 0.4699984036808"
[1] "p in problematic comparison is 0.466622317075728"
[1] "1-p0 problematic comparison is 0.5300015963192"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.466622317075728"
[1] "op os p0 before problematic comparison 0.466622317075728 0.988786322717211 0.47062784604545"
[1] "p in problematic comparison is 0.466330231806775"
[1] "1-p0 problematic comparison is 0.52937215395455"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.466330231806775"
[1] "op os p0 before problematic comparison 0.466330231806775 0.986453618514643 0.471174278925483"
[1] "p in problematic comparison is 0.466076962454666"
[1] "1-p0 problematic comparison is 0.528825721074517"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.466076962454666"
[1] "op os p0 before problematic comparison 0.466076962454666 0.984432979020314 0.471648832568457"
[1] "p in problematic comparison is 0.465857231927487"
[1] "1-p0 problematic comparison is 0.528351167431543"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.465857231927487"
[1] "op os p0 before problematic comparison 0.465857231927487 0.982681472154851 0.472061100190694"
[1] "p in problematic comparison is 0.465666509536568"
[1] "1-p0 problematic comparison is 0.527938899809306"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.465666509536568"
[1] "op os p0 before problematic comparison 0.465666509536568 0.981162361557189 0.472419361056212"
[1] "p in problematic comparison is 0.465500898411919"
[1] "1-p0 problematic comparison is 0.527580638943788"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.465500898411919"
[1] "op os p0 before problematic comparison 0.465500898411919 0.97984414248554 0.472730768590524"
[1] "p in problematic comparison is 0.46535704156521"
[1] "1-p0 problematic comparison is 0.527269231409476"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.46535704156521"
[1] "op os p0 before problematic comparison 0.46535704156521 0.978699744288982 0.473001509612562"
[1] "p in problematic comparison is 0.465232043128789"
[1] "1-p0 problematic comparison is 0.526998490387438"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.465232043128789"
[1] "op os p0 before problematic comparison 0.465232043128789 0.977705866896821 0.473236939574882"
[1] "p in problematic comparison is 0.465123402029654"
[1] "1-p0 problematic comparison is 0.526763060425118"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.465123402029654"
[1] "op os p0 before problematic comparison 0.465123402029654 0.976842425957914 0.473441697771925"
[1] "p in problematic comparison is 0.465028955916203"
[1] "1-p0 problematic comparison is 0.526558302228075"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.465028955916203"
[1] "op os p0 before problematic comparison 0.465028955916203 0.976092086686684 0.473619805744611"
[1] "p in problematic comparison is 0.464946833587126"
[1] "1-p0 problematic comparison is 0.526380194255389"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464946833587126"
[1] "op os p0 before problematic comparison 0.464946833587126 0.975439870605734 0.473774751529961"
[1] "p in problematic comparison is 0.464875414507711"
[1] "1-p0 problematic comparison is 0.526225248470039"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464875414507711"
[1] "op os p0 before problematic comparison 0.464875414507711 0.974872822552209 0.473909561941719"
[1] "p in problematic comparison is 0.464813294262405"
[1] "1-p0 problematic comparison is 0.526090438058281"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464813294262405"
[1] "op os p0 before problematic comparison 0.464813294262405 0.974379727778081 0.474026864695955"
[1] "p in problematic comparison is 0.464759255001012"
[1] "1-p0 problematic comparison is 0.525973135304045"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464759255001012"
[1] "op os p0 before problematic comparison 0.464759255001012 0.973950870899568 0.474128941894445"
[1] "p in problematic comparison is 0.464712240101949"
[1] "1-p0 problematic comparison is 0.525871058105555"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464712240101949"
[1] "op os p0 before problematic comparison 0.464712240101949 0.973577829967234 0.474217776133321"
[1] "p in problematic comparison is 0.464671332409296"
[1] "1-p0 problematic comparison is 0.525782223866679"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464671332409296"
[1] "op os p0 before problematic comparison 0.464671332409296 0.973253300131748 0.474295090303345"
[1] "p in problematic comparison is 0.464635735508043"
[1] "1-p0 problematic comparison is 0.525704909696655"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464635735508043"
[1] "op os p0 before problematic comparison 0.464635735508043 0.972970942342332 0.474362381982419"
[1] "p in problematic comparison is 0.464604757589481"
[1] "1-p0 problematic comparison is 0.525637618017581"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464604757589481"
[1] "op os p0 before problematic comparison 0.464604757589481 0.972725253289286 0.474420953183531"
[1] "p in problematic comparison is 0.464577797530319"
[1] "1-p0 problematic comparison is 0.525579046816469"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464577797530319"
[1] "op os p0 before problematic comparison 0.464577797530319 0.972511453429481 0.474471936106933"
[1] "p in problematic comparison is 0.464554332868048"
[1] "1-p0 problematic comparison is 0.525528063893067"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464554332868048"
[1] "op os p0 before problematic comparison 0.464554332868048 0.972325390445325 0.474516315449631"
[1] "p in problematic comparison is 0.464533909403798"
[1] "1-p0 problematic comparison is 0.525483684550369"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464533909403798"
[1] "op os p0 before problematic comparison 0.464533909403798 0.972163455907354 0.474554947744801"
[1] "p in problematic comparison is 0.464516132204524"
[1] "1-p0 problematic comparison is 0.525445052255199"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464516132204524"
[1] "op os p0 before problematic comparison 0.464516132204524 0.972022513256775 0.474588578135959"
[1] "p in problematic comparison is 0.464500657810163"
[1] "1-p0 problematic comparison is 0.525411421864041"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464500657810163"
[1] "op os p0 before problematic comparison 0.464500657810163 0.971899835511232 0.474617854933262"
[1] "p in problematic comparison is 0.46448718747985"
[1] "1-p0 problematic comparison is 0.525382145066738"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.46448718747985"
[1] "op os p0 before problematic comparison 0.46448718747985 0.97179305133623 0.474643342250601"
[1] "p in problematic comparison is 0.4644754613352"
[1] "1-p0 problematic comparison is 0.525356657749399"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.4644754613352"
[1] "op os p0 before problematic comparison 0.4644754613352 0.971700098324775 0.47466553098061"
[1] "p in problematic comparison is 0.464465253278875"
[1] "1-p0 problematic comparison is 0.52533446901939"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464465253278875"
[1] "op os p0 before problematic comparison 0.464465253278875 0.971619182495959 0.474684848329323"
[1] "p in problematic comparison is 0.464456366583829"
[1] "1-p0 problematic comparison is 0.525315151670677"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464456366583829"
[1] "op os p0 before problematic comparison 0.464456366583829 0.971548743165133 0.474701666101841"
[1] "p in problematic comparison is 0.464448630063203"
[1] "1-p0 problematic comparison is 0.525298333898159"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464448630063203"
[1] "op os p0 before problematic comparison 0.464448630063203 0.971487422458408 0.474716307904428"
[1] "p in problematic comparison is 0.464441894743288"
[1] "1-p0 problematic comparison is 0.525283692095572"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464441894743288"
[1] "op os p0 before problematic comparison 0.464441894743288 0.971434038846226 0.47472905540608"
[1] "p in problematic comparison is 0.464436030972612"
[1] "1-p0 problematic comparison is 0.52527094459392"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464436030972612"
[1] "op os p0 before problematic comparison 0.464436030972612 0.971387564157617 0.474740153783425"
[1] "p in problematic comparison is 0.464430925909327"
[1] "1-p0 problematic comparison is 0.525259846216575"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464430925909327"
[1] "op os p0 before problematic comparison 0.464430925909327 0.971347103610909 0.474749816456245"
[1] "p in problematic comparison is 0.464426481336897"
[1] "1-p0 problematic comparison is 0.525250183543755"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464426481336897"
[1] "op os p0 before problematic comparison 0.464426481336897 0.971311878460138 0.47475822920663"
[1] "p in problematic comparison is 0.464422611764807"
[1] "1-p0 problematic comparison is 0.52524177079337"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464422611764807"
[1] "op os p0 before problematic comparison 0.464422611764807 0.971281210910798 0.474765553762435"
[1] "p in problematic comparison is 0.464419242776823"
[1] "1-p0 problematic comparison is 0.525234446237565"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464419242776823"
[1] "op os p0 before problematic comparison 0.464419242776823 0.971254511005372 0.474771930915049"
[1] "p in problematic comparison is 0.464416309594313"
[1] "1-p0 problematic comparison is 0.525228069084951"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464416309594313"
[1] "op os p0 before problematic comparison 0.464416309594313 0.971231265219254 0.474777483232254"
[1] "p in problematic comparison is 0.464413755826465"
[1] "1-p0 problematic comparison is 0.525222516767746"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464413755826465"
[1] "op os p0 before problematic comparison 0.464413755826465 0.971211026542394 0.474782317418945"
[1] "p in problematic comparison is 0.464411532382974"
[1] "1-p0 problematic comparison is 0.525217682581055"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464411532382974"
[1] "op os p0 before problematic comparison 0.464411532382974 0.971193405851854 0.474786526371578"
[1] "p in problematic comparison is 0.464409596527964"
[1] "1-p0 problematic comparison is 0.525213473628422"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464409596527964"
[1] "op os p0 before problematic comparison 0.464409596527964 0.971178064406345 0.474790190966195"
[1] "p in problematic comparison is 0.464407911056744"
[1] "1-p0 problematic comparison is 0.525209809033805"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464407911056744"
[1] "op os p0 before problematic comparison 0.464407911056744 0.97116470731611 0.474793381614644"
[1] "p in problematic comparison is 0.464406443579387"
[1] "1-p0 problematic comparison is 0.525206618385356"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464406443579387"
[1] "op os p0 before problematic comparison 0.464406443579387 0.971153077860885 0.47479615961913"
[1] "p in problematic comparison is 0.464405165897232"
[1] "1-p0 problematic comparison is 0.52520384038087"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464405165897232"
[1] "op os p0 before problematic comparison 0.464405165897232 0.971142952545373 0.474798578351269"
[1] "p in problematic comparison is 0.464404053460229"
[1] "1-p0 problematic comparison is 0.525201421648731"
[1] "m^2  problematic comparison is 4.54767284683578"
[1] "m2-m^2 problematic comparison problematic comparison is 2.43273678196451"
[1] "p in  problematic comparison comparison is 0.464404053460229"
[1] "summary negative log10 NB p-value:"
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
  0.0000   0.0000   0.2835   0.4498   0.4885 323.0052 
[1] "output_name in r script is"
[1] "SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes.bedgraph.s3norm.NB.neglog10p.bedgraph"
[1] "dim neglog10_nb_pval_bedgraph is 65788"
[2] "dim neglog10_nb_pval_bedgraph is 4"    
[1] "head neglog10_nb_pval_bedgraph is"
    V1      V2      V3 neglog10_nb_pval
1 chr1  898400  898600        0.4985011
2 chr1 1165600 1165800        0.1407052
3 chr1 1165800 1166000        0.0000000
4 chr1 1270800 1271000        0.6418388
5 chr1 1402200 1402400        0.1299037
6 chr1 1402400 1402600        0.0000000
read first file name
get bed file
get first file signals
SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes.bedgraph
get all file signals
SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes.bedgraph
cut: SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes.bedgraph.s3norm.NB.neglog10p.bedgraph: No such file or directory
get average_ref
get reference mean
get output bedgraph file
User provide reference.bedgraph: -r average_ref.bedgraph.NBP.bedgraph
User provide target.bedgraph: -t SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes.bedgraph.s3norm.NB.neglog10p.bedgraph
User provide outputname: -o SCC-ChIC-PMC-DRO-T1_binsize_200_nozeroes.bedgraph.NBP
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p neglog10p
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
User provide cross_mark: -c F
start S3norm.......
test
('sig1_raw[:,1] is', array(['898400', '1165600', '1165800', ..., '66400', '66600', '66800'],
      dtype='|S10'), 'sig2_raw[:,1] is', array(['898400', '1165600', '1165800', ..., '66400', '66600', '66800'],
      dtype='|S20'), 'bin_num is', 65788)
('length sig1', 65788)
('length sig2', 65788)
check peak number in reference
reference_pk_num
4894
check peak number in target
target_pk_num
297
reference_pk_num
4894
target_pk_num
297
use FDR common peaks
use FDR common background
common peaks number:
297
common background number:
60894
check!!!
0
Iteration 0 | dFB: 0.091564
[4.107093129647009, 1.908435673556701]
Iteration 10 | dFB: 0.045833
[2.3562879155370475, 1.1083162125188506]
Iteration 20 | dFB: 0.000099
[2.2310287611148008, 1.0349871723750534]
converged!
used: [A, B]
[2.2308737688457803, 1.0348945296032859]
transformation: B: 1.0348945296032859; A: 2.2308737688457803
User provide reference.bedgraph: -r average_ref.bedgraph.NBP.bedgraph
User provide target.bedgraph: -t SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes.bedgraph.s3norm.NB.neglog10p.bedgraph
User provide outputname: -o SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes.bedgraph.NBP
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p neglog10p
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
User provide cross_mark: -c F
start S3norm.......
Traceback (most recent call last):
  File "/hpc/pmc_drost/nhung/S3norm/src//s3norm.py", line 477, in <module>
    main(sys.argv[1:])
  File "/hpc/pmc_drost/nhung/S3norm/src//s3norm.py", line 474, in main
    s3norm(sig1_wg_raw, sig2_wg_raw, sig2_output_name, NTmethod, B_init, fdr_thresh, rank_lim, upperlim, lowerlim, p_method, common_pk_binary, common_bg_binary, cross_mark)
  File "/hpc/pmc_drost/nhung/S3norm/src//s3norm.py", line 182, in s3norm
    sig2_raw = read2d_array(sig2_wg_raw, str)
  File "/hpc/pmc_drost/nhung/S3norm/src//s3norm.py", line 11, in read2d_array
    data=open(filename,'r')
IOError: [Errno 2] No such file or directory: 'SCC-ChIC-PMC-DRO-T5_binsize_200_nozeroes.bedgraph.s3norm.NB.neglog10p.bedgraph'
User provide script_folder: -s /hpc/pmc_drost/nhung/S3norm/src/
User provide input_file_list: -t /hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/bincount_bamcoverage_fixbinsize//nozeros_4file.txt
Default reference_method: -m max1
Default NTmethod: -m non0mean
Default B_init: -i 2.0
Default fdr_thresh: -f 0.05
Default rank_lim: -l 0.001
Default upperlim: -a 100000
Default lowerlim: -b 0
Default p_method: -p z
Default common_pk_binary: -k 0
Default common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
('Filelist is', '/hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/bincount_bamcoverage_fixbinsize//nozeros_4file.txt')
('script_folder is', '/hpc/pmc_drost/nhung/S3norm/src/')
Get average reference......
Get average reference......Done
Get S3norm normalized read counts......
Get S3norm normalized read counts......Done
Get signal track of negative log10 p-value based on a NB background model......
Get signal track of negative log10 p-value based on a NB background model......Done
Get NBP average reference......
Get NBP average reference......Done
Get S3norm normalized negative log10 p-value based on NB background model......
Get S3norm normalized negative log10 p-value based on NB background model......Done
Organize folder......
Save S3norm_NBP_bedgraph
Save S3norm_rc_bedgraph
Save NBP_bedgraph
Save average_ref_bedgraph
Organize folder......Done

real	0m6.163s
user	0m11.609s
sys	0m1.807s
