mkdir: cannot create directory ‘/remove_zero’: Permission denied
start running cut and run analysis at Mon May 29 10:28:32 CEST 2023
-------------------step 7. running data normalization------ 
read first file name
get bed file
get first file signals
SCC-bulkChIC-PMC-DRO-020_nozeroes_augmented.bedgraph
get all file signals
SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph
get average_ref
get reference  max1
[1] "SCC-bulkChIC-PMC-DRO-020_nozeroes_augmented.bedgraph FRiP score: 0.0547671861997142"
[1] "SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph FRiP score: 0.00739454052656402"
[1] "Used reference"
[1] "max1"
     filenames_used                                        
[1,] "SCC-bulkChIC-PMC-DRO-020_nozeroes_augmented.bedgraph"
     frip_used           
[1,] "0.0547671861997142"
get output bedgraph file
User provide reference.bedgraph: -r average_ref.bedgraph
User provide target.bedgraph: -t SCC-bulkChIC-PMC-DRO-020_nozeroes_augmented.bedgraph
User provide outputname: -o SCC-bulkChIC-PMC-DRO-020_nozeroes_augmented.bedgraph
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p z
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
('length sig1_raw', 13784097)
('length_sig2_raw', 13784097)
check peak number in reference
reference_pk_num
85707
check peak number in target
target_pk_num
85707
reference_pk_num
85707
target_pk_num
85707
use FDR common peaks
use FDR common background
common peaks number:
85707
common background number:
13698390
check!!!
13784097
Iteration 0 | dFB: 0.122663
[0.25608368177344865, 1.87733664750934]
Iteration 10 | dFB: 0.034242
[0.9404147618213559, 1.047718530515811]
Iteration 20 | dFB: 0.000058
[0.9999266375683709, 1.0000577364491012]
converged!
used: [A, B]
[0.9999908274216757, 1.000007218715471]
transformation: B: 1.000007218715471; A: 0.9999908274216757
User provide reference.bedgraph: -r average_ref.bedgraph
User provide target.bedgraph: -t SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph
User provide outputname: -o SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p z
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
('length sig1_raw', 13784097)
('length_sig2_raw', 13784097)
check peak number in reference
reference_pk_num
85707
check peak number in target
target_pk_num
5698
fdr peak number < bin_num * rank_lim
use rank for target
22.0
reference_pk_num
85707
target_pk_num
5698
use FDR common peaks
use FDR common background
common peaks number:
7419
common background number:
13691566
check!!!
5061807
Iteration 0 | dFB: 0.085472
[0.2068220674930263, 1.9145281186951606]
Iteration 10 | dFB: 0.058606
[0.6563802840137811, 1.2222382082563947]
Iteration 20 | dFB: 0.001063
[0.8950539471016515, 1.0033724110331201]
converged!
used: [A, B]
[0.8963492309093029, 1.0023010007438244]
transformation: B: 1.0023010007438244; A: 0.8963492309093029
Error in file(file, "rt") : cannot open the connection
Calls: read.table -> file
In addition: Warning message:
In file(file, "rt") :
  cannot open file 'SCC-bulkChIC-PMC-DRO-020_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph': No such file or directory
Execution halted
Error in file(file, "rt") : cannot open the connection
Calls: read.table -> file
In addition: Warning message:
In file(file, "rt") :
  cannot open file 'SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph': No such file or directory
Execution halted
Error in file(file, "rt") : cannot open the connection
Calls: read.table -> file
In addition: Warning message:
In file(file, "rt") :
  cannot open file '.s3norm.bedgraph': No such file or directory
Execution halted
read first file name
get bed file
cut: SCC-bulkChIC-PMC-DRO-020_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph: No such file or directory
get first file signals
SCC-bulkChIC-PMC-DRO-020_nozeroes_augmented.bedgraph
get all file signals
SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph
cut: SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph: No such file or directory
get average_ref
get reference  max1
Error in file(file, "rt") : cannot open the connection
Calls: read.table -> file
In addition: Warning message:
In file(file, "rt") :
  cannot open file 'SCC-bulkChIC-PMC-DRO-020_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph': No such file or directory
Execution halted
get output bedgraph file
paste: sigmat.average_ref.txt: No such file or directory
rm: cannot remove ‘sigmat.average_ref.txt’: No such file or directory
User provide reference.bedgraph: -r average_ref.bedgraph.NBP.bedgraph
User provide target.bedgraph: -t SCC-bulkChIC-PMC-DRO-020_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph
User provide outputname: -o SCC-bulkChIC-PMC-DRO-020_nozeroes_augmented.bedgraph.NBP
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p neglog10p
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
User provide cross_mark: -c F
start S3norm.......
Traceback (most recent call last):
  File "/hpc/pmc_drost/nhung/s3norm_yichao/S3norm/src//s3norm.py", line 474, in <module>
    main(sys.argv[1:])
  File "/hpc/pmc_drost/nhung/s3norm_yichao/S3norm/src//s3norm.py", line 471, in main
    s3norm(sig1_wg_raw, sig2_wg_raw, sig2_output_name, NTmethod, B_init, fdr_thresh, rank_lim, upperlim, lowerlim, p_method, common_pk_binary, common_bg_binary, cross_mark)
  File "/hpc/pmc_drost/nhung/s3norm_yichao/S3norm/src//s3norm.py", line 182, in s3norm
    sig2_raw = read2d_array(sig2_wg_raw, str)
  File "/hpc/pmc_drost/nhung/s3norm_yichao/S3norm/src//s3norm.py", line 11, in read2d_array
    data=open(filename,'r')
IOError: [Errno 2] No such file or directory: 'SCC-bulkChIC-PMC-DRO-020_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph'
User provide reference.bedgraph: -r average_ref.bedgraph.NBP.bedgraph
User provide target.bedgraph: -t SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph
User provide outputname: -o SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph.NBP
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p neglog10p
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
User provide cross_mark: -c F
start S3norm.......
Traceback (most recent call last):
  File "/hpc/pmc_drost/nhung/s3norm_yichao/S3norm/src//s3norm.py", line 474, in <module>
    main(sys.argv[1:])
  File "/hpc/pmc_drost/nhung/s3norm_yichao/S3norm/src//s3norm.py", line 471, in main
    s3norm(sig1_wg_raw, sig2_wg_raw, sig2_output_name, NTmethod, B_init, fdr_thresh, rank_lim, upperlim, lowerlim, p_method, common_pk_binary, common_bg_binary, cross_mark)
  File "/hpc/pmc_drost/nhung/s3norm_yichao/S3norm/src//s3norm.py", line 182, in s3norm
    sig2_raw = read2d_array(sig2_wg_raw, str)
  File "/hpc/pmc_drost/nhung/s3norm_yichao/S3norm/src//s3norm.py", line 11, in read2d_array
    data=open(filename,'r')
IOError: [Errno 2] No such file or directory: 'SCC-bulkChIC-PMC-DRO-023_nozeroes_augmented.bedgraph.s3norm.NB.neglog10p.bedgraph'
mv: cannot stat ‘*.NBP.info.txt’: No such file or directory
mv: cannot stat ‘*.NBP.s3norm.bedgraph’: No such file or directory
mv: cannot stat ‘*.s3norm.NB.neglog10p.bedgraph’: No such file or directory
mv: missing destination file operand after ‘/hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/modify_bedgraph/s3norm_anti_SFPQ_Samples/anti_sfpq_samples.csv’
Try 'mv --help' for more information.
User provide script_folder: -s /hpc/pmc_drost/nhung/s3norm_yichao/S3norm/src/
User provide input_file_list: -t /hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/modify_bedgraph/s3norm_anti_SFPQ_Samples/anti_sfpq_samples.csv
Default reference_method: -m max1
Default NTmethod: -m non0mean
Default B_init: -i 2.0
Default fdr_thresh: -f 0.05
Default rank_lim: -l 0.001
Default upperlim: -a 100000
Default lowerlim: -b 0
Default p_method: -p z
Default common_pk_binary: -k 0
Default common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
Get average reference......
Get average reference......Done
Get S3norm normalized read counts......
Get S3norm normalized read counts......Done
Get signal track of negative log10 p-value based on a NB background model......
Get signal track of negative log10 p-value based on a NB background model......Done
Get NBP average reference......
Get NBP average reference......Done
Get S3norm normalized negative log10 p-value based on NB background model......
Get S3norm normalized negative log10 p-value based on NB background model......Done
Organize folder......
Save S3norm_NBP_bedgraph
Save S3norm_rc_bedgraph
Save NBP_bedgraph
Save average_ref_bedgraph
Organize folder......Done

real	11m22.366s
user	11m52.702s
sys	1m26.038s
/var/spool/slurm/d/job27560357/slurm_script: line 381: ./7-run_s3norm.sh: No such file or directory
/var/spool/slurm/d/job27560357/slurm_script: line 385: ./7-run_s3norm.sh: No such file or directory
/var/spool/slurm/d/job27560357/slurm_script: line 389: ./7-run_s3norm.sh: No such file or directory
finish cut and run analysis at Mon May 29 10:39:54 CEST 2023
