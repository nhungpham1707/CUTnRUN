read first file name
head: cannot open '/hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/s3norm_example_file/s3norm_tab_file_list.txt' for reading: No such file or directory
get bed file
get first file signals

get all file signals
tail: cannot open '/hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/s3norm_example_file/s3norm_tab_file_list.txt' for reading: No such file or directory
get average_ref
get reference mean
get output bedgraph file
cat: /hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/s3norm_example_file/s3norm_tab_file_list.txt: No such file or directory
/bin/sh: /hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/s3norm_example_file/s3norm_tab_file_list.txt: No such file or directory
read first file name
head: cannot open '/hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/s3norm_example_file/s3norm_tab_file_list.txt' for reading: No such file or directory
get bed file
cut: .s3norm.NB.neglog10p.bedgraph: No such file or directory
get first file signals

get all file signals
tail: cannot open '/hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/s3norm_example_file/s3norm_tab_file_list.txt' for reading: No such file or directory
get average_ref
get reference mean
get output bedgraph file
cat: /hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/s3norm_example_file/s3norm_tab_file_list.txt: No such file or directory
mv: cannot stat '*.NBP.info.txt': No such file or directory
mv: cannot stat '*.NBP.s3norm.bedgraph': No such file or directory
mv: cannot stat '*.info.txt': No such file or directory
mv: cannot stat '*.s3norm.bedgraph': No such file or directory
mv: cannot stat '*.s3norm.NB.neglog10p.bedgraph': No such file or directory
User provide script_folder: -s /hpc/pmc_drost/nhung/S3norm/src/
User provide input_file_list: -t /hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/s3norm_example_file/s3norm_tab_file_list.txt
Default reference_method: -m max1
Default NTmethod: -m non0mean
Default B_init: -i 2.0
Default fdr_thresh: -f 0.05
Default rank_lim: -l 0.001
Default upperlim: -a 100000
Default lowerlim: -b 0
Default p_method: -p z
Default common_pk_binary: -k 0
Default common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
Get average reference......
Get average reference......Done
Get S3norm normalized read counts......
Get S3norm normalized read counts......Done
Get signal track of negative log10 p-value based on a NB background model......
Get signal track of negative log10 p-value based on a NB background model......Done
Get NBP average reference......
Get NBP average reference......Done
Get S3norm normalized negative log10 p-value based on NB background model......
Get S3norm normalized negative log10 p-value based on NB background model......Done
Organize folder......
Save S3norm_NBP_bedgraph
Save S3norm_rc_bedgraph
Save NBP_bedgraph
Save average_ref_bedgraph
Organize folder......Done

real	0m7.428s
user	0m0.295s
sys	0m0.355s
read first file name
get bed file
get first file signals
sig1.sorted.bedgraph
get all file signals
sig2.sorted.bedgraph
sig3.sorted.bedgraph
get average_ref
get reference mean
get output bedgraph file
User provide reference.bedgraph: -r average_ref.bedgraph
User provide target.bedgraph: -t sig1.sorted.bedgraph
User provide outputname: -o sig1.sorted.bedgraph
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p z
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
check peak number in reference
reference_pk_num
691
check peak number in target
target_pk_num
541
reference_pk_num
691
target_pk_num
541
use FDR common peaks
use FDR common background
common peaks number:
393
common background number:
99161
check!!!
8337
Iteration 0 | dFB: 0.097131
[0.00729808829546189, 1.902869025542364]
Iteration 10 | dFB: 0.005061
[0.1696827392178091, 1.2973107553907133]
Iteration 20 | dFB: 0.000378
[0.1867710826732952, 1.2790988296301804]
Iteration 30 | dFB: 0.000017
[0.18775854213268026, 1.278097059889425]
converged!
used: [A, B]
[0.18778051989183034, 1.278074822497892]
transformation: B: 1.278074822497892; A: 0.18778051989183034
User provide reference.bedgraph: -r average_ref.bedgraph
User provide target.bedgraph: -t sig2.sorted.bedgraph
User provide outputname: -o sig2.sorted.bedgraph
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p z
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
check peak number in reference
reference_pk_num
691
check peak number in target
target_pk_num
718
reference_pk_num
691
target_pk_num
718
use FDR common peaks
use FDR common background
common peaks number:
583
common background number:
99174
check!!!
8338
Iteration 0 | dFB: 0.092576
[0.00686332502027158, 1.9074240642638927]
Iteration 10 | dFB: 0.034899
[0.21704992619379088, 1.2134027492727295]
Iteration 20 | dFB: 0.001941
[0.5798327549026999, 1.0446006229327252]
converged!
used: [A, B]
[0.5874702816460179, 1.042306601817472]
transformation: B: 1.042306601817472; A: 0.5874702816460179
User provide reference.bedgraph: -r average_ref.bedgraph
User provide target.bedgraph: -t sig3.sorted.bedgraph
User provide outputname: -o sig3.sorted.bedgraph
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p z
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
check peak number in reference
reference_pk_num
691
check peak number in target
target_pk_num
725
reference_pk_num
691
target_pk_num
725
use FDR common peaks
use FDR common background
common peaks number:
622
common background number:
99206
check!!!
8339
Iteration 0 | dFB: 0.092794
[0.007500780597268804, 1.907205544625878]
Iteration 10 | dFB: 0.039372
[0.1808050825737128, 1.2369468272074338]
Iteration 20 | dFB: 0.006290
[0.8476148251803103, 0.9784318782857656]
Iteration 30 | dFB: 0.000008
[0.8852851918492408, 0.9708705212645866]
converged!
used: [A, B]
[0.8852851918492408, 0.9708705212645866]
transformation: B: 0.9708705212645866; A: 0.8852851918492408
[1] "summary negative log10 NB p-value:"
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
  0.0000   0.1272   0.3182   0.6135   0.6273 323.0052 
[1] "summary negative log10 NB p-value:"
    Min.  1st Qu.   Median     Mean  3rd Qu.     Max. 
  0.0000   0.0000   0.3734   0.4834   0.6545 110.7977 
[1] "summary negative log10 NB p-value:"
   Min. 1st Qu.  Median    Mean 3rd Qu.    Max. 
 0.0000  0.0000  0.3289  0.4629  0.6789 75.2250 
read first file name
get bed file
get first file signals
sig1.sorted.bedgraph
get all file signals
sig2.sorted.bedgraph
sig3.sorted.bedgraph
get average_ref
get reference mean
get output bedgraph file
User provide reference.bedgraph: -r average_ref.bedgraph.NBP.bedgraph
User provide target.bedgraph: -t sig1.sorted.bedgraph.s3norm.NB.neglog10p.bedgraph
User provide outputname: -o sig1.sorted.bedgraph.NBP
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p neglog10p
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
User provide cross_mark: -c F
start S3norm.......
check peak number in reference
reference_pk_num
88929
check peak number in target
target_pk_num
1154
reference_pk_num
88929
target_pk_num
1154
use FDR common peaks
use FDR common background
common peaks number:
1154
common background number:
11071
check!!!
8381
Iteration 0 | dFB: 0.108337
[149.1850264549643, 1.8916631226650413]
Iteration 10 | dFB: 0.006028
[20.340965249599975, 1.2207485005808034]
Iteration 20 | dFB: 0.000006
[19.976249323379985, 1.2146564433375033]
converged!
used: [A, B]
[19.976249323379985, 1.2146564433375033]
transformation: B: 1.2146564433375033; A: 19.976249323379985
User provide reference.bedgraph: -r average_ref.bedgraph.NBP.bedgraph
User provide target.bedgraph: -t sig2.sorted.bedgraph.s3norm.NB.neglog10p.bedgraph
User provide outputname: -o sig2.sorted.bedgraph.NBP
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p neglog10p
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
User provide cross_mark: -c F
start S3norm.......
check peak number in reference
reference_pk_num
88929
check peak number in target
target_pk_num
1115
reference_pk_num
88929
target_pk_num
1115
use FDR common peaks
use FDR common background
common peaks number:
1115
common background number:
11071
check!!!
8381
Iteration 0 | dFB: -0.225280
[1.928347063258621, 2.22527954595081]
Iteration 10 | dFB: -0.000058
[1.9820969989197592, 2.299564065960921]
converged!
used: [A, B]
[1.9821333078543188, 2.2996144211966234]
transformation: B: 2.2996144211966234; A: 1.9821333078543188
User provide reference.bedgraph: -r average_ref.bedgraph.NBP.bedgraph
User provide target.bedgraph: -t sig3.sorted.bedgraph.s3norm.NB.neglog10p.bedgraph
User provide outputname: -o sig3.sorted.bedgraph.NBP
User provide NTmethod: -m non0mean
User provide B_init: -i 2.0
User provide fdr_thresh: -f 0.05
User provide rank_lim: -l 0.001
User provide upperlim: -a 100000.0
User provide lowerlim: -b 0.0
User provide p_method: -p neglog10p
User provide common_pk_binary: -k 0
User provide common_bg_binary: -g 0
User provide cross_mark: -c F
start S3norm.......
check peak number in reference
reference_pk_num
88929
check peak number in target
target_pk_num
1115
reference_pk_num
88929
target_pk_num
1115
use FDR common peaks
use FDR common background
common peaks number:
1115
common background number:
11071
check!!!
8381
Iteration 0 | dFB: -0.469012
[1.4797626554870476, 2.469011703885657]
Iteration 10 | dFB: -0.000030
[1.4896852096081856, 2.5034809603410624]
converged!
used: [A, B]
[1.4896916744529285, 2.503503740980853]
transformation: B: 2.503503740980853; A: 1.4896916744529285
User provide script_folder: -s /hpc/pmc_drost/nhung/S3norm/src/
User provide input_file_list: -t /hpc/pmc_drost/PROJECTS/swang/CUT_RUN/nhung_test/s3norm_example_file/file_list.txt
Default reference_method: -m max1
Default NTmethod: -m non0mean
Default B_init: -i 2.0
Default fdr_thresh: -f 0.05
Default rank_lim: -l 0.001
Default upperlim: -a 100000
Default lowerlim: -b 0
Default p_method: -p z
Default common_pk_binary: -k 0
Default common_bg_binary: -g 0
Default cross_mark: -c F
start S3norm.......
Get average reference......
Get average reference......Done
Get S3norm normalized read counts......
Get S3norm normalized read counts......Done
Get signal track of negative log10 p-value based on a NB background model......
Get signal track of negative log10 p-value based on a NB background model......Done
Get NBP average reference......
Get NBP average reference......Done
Get S3norm normalized negative log10 p-value based on NB background model......
Get S3norm normalized negative log10 p-value based on NB background model......Done
Organize folder......
Save S3norm_NBP_bedgraph
Save S3norm_rc_bedgraph
Save NBP_bedgraph
Save average_ref_bedgraph
Organize folder......Done

real	0m31.986s
user	0m40.448s
sys	0m5.519s
